{"file_contents":{"client/src/lib/fileUtils.ts":{"content":"import { type LucideIcon, FileText, Image, Video, Music, Archive, File, Folder } from 'lucide-react';\n\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n  \n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  \n  return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n}\n\nexport function formatDate(date: Date | string): string {\n  const d = typeof date === 'string' ? new Date(date) : date;\n  const now = new Date();\n  const diff = now.getTime() - d.getTime();\n  \n  // Less than 1 minute\n  if (diff < 60 * 1000) {\n    return 'Just now';\n  }\n  \n  // Less than 1 hour\n  if (diff < 60 * 60 * 1000) {\n    const minutes = Math.floor(diff / (60 * 1000));\n    return `${minutes} ${minutes === 1 ? 'minute' : 'minutes'} ago`;\n  }\n  \n  // Less than 1 day\n  if (diff < 24 * 60 * 60 * 1000) {\n    const hours = Math.floor(diff / (60 * 60 * 1000));\n    return `${hours} ${hours === 1 ? 'hour' : 'hours'} ago`;\n  }\n  \n  // Less than 7 days\n  if (diff < 7 * 24 * 60 * 60 * 1000) {\n    const days = Math.floor(diff / (24 * 60 * 60 * 1000));\n    return `${days} ${days === 1 ? 'day' : 'days'} ago`;\n  }\n  \n  // Format as date\n  return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });\n}\n\nexport interface FileTypeInfo {\n  icon: LucideIcon;\n  color: string;\n  bgColor: string;\n}\n\nexport function getFileTypeInfo(fileName: string, mimeType?: string): FileTypeInfo {\n  const ext = fileName.split('.').pop()?.toLowerCase() || '';\n  \n  // Check mime type first\n  if (mimeType) {\n    if (mimeType.startsWith('image/')) {\n      return { icon: Image, color: 'text-green-600', bgColor: 'bg-green-50 dark:bg-green-950' };\n    }\n    if (mimeType.startsWith('video/')) {\n      return { icon: Video, color: 'text-purple-600', bgColor: 'bg-purple-50 dark:bg-purple-950' };\n    }\n    if (mimeType.startsWith('audio/')) {\n      return { icon: Music, color: 'text-orange-600', bgColor: 'bg-orange-50 dark:bg-orange-950' };\n    }\n  }\n  \n  // Document types\n  const documentExts = ['pdf', 'doc', 'docx', 'txt', 'rtf', 'odt', 'pages'];\n  if (documentExts.includes(ext)) {\n    return { icon: FileText, color: 'text-blue-600', bgColor: 'bg-blue-50 dark:bg-blue-950' };\n  }\n  \n  // Image types\n  const imageExts = ['jpg', 'jpeg', 'png', 'gif', 'svg', 'webp', 'bmp', 'ico'];\n  if (imageExts.includes(ext)) {\n    return { icon: Image, color: 'text-green-600', bgColor: 'bg-green-50 dark:bg-green-950' };\n  }\n  \n  // Video types\n  const videoExts = ['mp4', 'mov', 'avi', 'mkv', 'webm', 'flv', 'wmv'];\n  if (videoExts.includes(ext)) {\n    return { icon: Video, color: 'text-purple-600', bgColor: 'bg-purple-50 dark:bg-purple-950' };\n  }\n  \n  // Audio types\n  const audioExts = ['mp3', 'wav', 'aac', 'flac', 'ogg', 'm4a', 'wma'];\n  if (audioExts.includes(ext)) {\n    return { icon: Music, color: 'text-orange-600', bgColor: 'bg-orange-50 dark:bg-orange-950' };\n  }\n  \n  // Archive types\n  const archiveExts = ['zip', 'rar', '7z', 'tar', 'gz', 'bz2', 'xz'];\n  if (archiveExts.includes(ext)) {\n    return { icon: Archive, color: 'text-gray-600', bgColor: 'bg-gray-50 dark:bg-gray-950' };\n  }\n  \n  // Default\n  return { icon: File, color: 'text-gray-600', bgColor: 'bg-gray-50 dark:bg-gray-950' };\n}\n\nexport function getFolderIcon(): FileTypeInfo {\n  return { icon: Folder, color: 'text-yellow-600', bgColor: 'bg-yellow-50 dark:bg-yellow-950' };\n}\n\nexport function sanitizeFileName(fileName: string): string {\n  // Remove special characters and replace spaces\n  return fileName.replace(/[^a-zA-Z0-9.-]/g, '_');\n}\n\nexport function getFileExtension(fileName: string): string {\n  return fileName.split('.').pop()?.toLowerCase() || '';\n}\n\nexport function isImageFile(fileName: string, mimeType?: string): boolean {\n  if (mimeType && mimeType.startsWith('image/')) return true;\n  const ext = getFileExtension(fileName);\n  const imageExts = ['jpg', 'jpeg', 'png', 'gif', 'svg', 'webp', 'bmp'];\n  return imageExts.includes(ext);\n}\n","size_bytes":4045},"backend/models/__init__.py":{"content":"from backend.models.user import User, Role\nfrom backend.models.file import File, ShareLink\n\n__all__ = [\"User\", \"Role\", \"File\", \"ShareLink\"]\n","size_bytes":140},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/FileUploadZone.tsx":{"content":"import { useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { Upload, FileUp } from 'lucide-react';\nimport { cn } from '@/lib/utils';\n\ninterface FileUploadZoneProps {\n  onFilesSelected: (files: File[]) => void;\n  isUploading?: boolean;\n  folderId?: string;\n}\n\nexport function FileUploadZone({ onFilesSelected, isUploading = false }: FileUploadZoneProps) {\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    if (acceptedFiles.length > 0 && !isUploading) {\n      onFilesSelected(acceptedFiles);\n    }\n  }, [onFilesSelected, isUploading]);\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    disabled: isUploading,\n  });\n\n  return (\n    <div\n      {...getRootProps()}\n      className={cn(\n        'relative overflow-hidden rounded-lg border-2 border-dashed transition-all duration-200',\n        'min-h-48 flex flex-col items-center justify-center gap-4 p-8',\n        'hover-elevate active-elevate-2 cursor-pointer',\n        isDragActive && !isUploading && 'border-primary bg-primary/5',\n        !isDragActive && 'border-border',\n        isUploading && 'opacity-50 cursor-not-allowed'\n      )}\n      data-testid=\"upload-zone\"\n    >\n      <input {...getInputProps()} data-testid=\"file-input\" />\n      \n      <div className=\"flex flex-col items-center gap-3 text-center\">\n        {isDragActive ? (\n          <FileUp className=\"h-12 w-12 text-primary animate-bounce\" />\n        ) : (\n          <Upload className=\"h-12 w-12 text-muted-foreground\" />\n        )}\n        \n        <div className=\"space-y-1\">\n          <p className=\"text-base font-medium text-foreground\">\n            {isDragActive ? 'Drop files here' : 'Drag & drop files here'}\n          </p>\n          <p className=\"text-sm text-muted-foreground\">\n            or click to browse your computer\n          </p>\n        </div>\n        \n        {!isDragActive && (\n          <p className=\"text-xs text-muted-foreground max-w-md\">\n            Supports all file types. Multiple files can be uploaded at once.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":2094},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"replit.md":{"content":"# EnlitEDU SFTP - Secure File Transfer & Storage Platform\n\n## Overview\n\nEnlitEDU SFTP is a secure cloud-based file storage and transfer platform that enables users to upload, manage, and share files with enterprise-grade security. The application provides role-based access control, AWS S3 integration for reliable storage, and features like file sharing with expiration, file operations (copy, delete, download), comprehensive folder management, and user management for administrators. The platform displays ALL S3 bucket contents (not just app-uploaded files) and supports folder creation, navigation, and breadcrumb trails.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React 18 with TypeScript and Vite for fast development and optimized production builds.\n\n**UI Component System**: Built on shadcn/ui components (Radix UI primitives) with TailwindCSS for styling, following Material Design 3 principles adapted for file management applications. The design emphasizes clarity, efficiency, and trust through consistent patterns and professional appearance.\n\n**State Management**: \n- React Query (@tanstack/react-query) for server state management, data fetching, and caching\n- Local React state for UI interactions (view modes, search, selections)\n- Session-based authentication with tokens stored in localStorage\n\n**Routing**: Wouter for lightweight client-side routing with protected routes for authenticated users and admin-only sections.\n\n**Key Design Decisions**:\n- Grid and list view modes for file browsing flexibility\n- Real-time upload progress tracking with visual feedback\n- File type detection with appropriate icons and colors\n- Folder navigation with breadcrumb trails for hierarchical browsing\n- Hybrid file listing showing all S3 bucket files (both tracked and external)\n- Folder icons and clickable navigation for intuitive folder browsing\n- EnlitEDU branding throughout the application\n- Responsive design with mobile-first approach\n- Typography using Inter font for clarity and SF Mono for technical data\n\n### Backend Architecture\n\n**Framework**: FastAPI (Python) providing high-performance async API endpoints with automatic OpenAPI documentation.\n\n**Database ORM**: SQLAlchemy with PostgreSQL for relational data persistence. Connection pooling configured with pre-ping validation and automatic connection recycling to handle SSL connection issues reliably.\n\n**Authentication & Authorization**:\n- JWT (JSON Web Tokens) for stateless authentication using python-jose\n- BCrypt password hashing via bcryptjs for secure credential storage\n- HTTP Bearer token scheme for API authentication\n- Role-based access control (RBAC) with granular permissions (read, write, copy, delete, share)\n- Four default roles: Admin, Editor, Viewer, Contributor\n\n**API Design**:\n- RESTful endpoints organized by domain (auth, users, roles, files)\n- CORS middleware configured for cross-origin requests\n- Structured error handling with appropriate HTTP status codes\n- Request/response validation using Pydantic models\n\n**Build & Deployment**:\n- Frontend built with Vite, backend bundled with esbuild\n- Single server process using Uvicorn (ASGI server) serving both API and static frontend\n- Production mode serves pre-built React SPA from FastAPI static file routes\n\n### Data Storage\n\n**Primary Database**: PostgreSQL for structured data including users, roles, file metadata, and share links.\n\n**Database Schema**:\n- `users` table with username, email, hashed password, admin flag, and audit fields\n- `roles` table defining permission sets (can_read, can_write, can_copy, can_delete, can_share)\n- `user_roles` junction table for many-to-many user-role relationships\n- `files` table storing file metadata (filename, S3 key, size, content type, folder path, owner)\n- `share_links` table for temporary file sharing with tokens and expiration\n\n**File Storage**: AWS S3 for scalable object storage with presigned URLs for secure direct client-to-S3 uploads and downloads.\n\n**Key Design Decisions**:\n- File content stored in S3, metadata in PostgreSQL for performance and cost optimization\n- Hybrid file listing: combines S3 bucket objects with database metadata to show ALL files (not just app-uploaded ones)\n- External S3 files (without database records) are marked as \"External\" and support download-only\n- Folder management using `.keep` sentinel files to mark empty folders in S3\n- Sentinel files filtered from display but contribute to folder structure detection\n- Presigned URLs eliminate backend bottleneck for file transfers\n- Cascade delete on share_links when parent file is deleted\n- Connection pooling to prevent SSL timeout issues with serverless databases\n\n### External Dependencies\n\n**Cloud Services**:\n- AWS S3 for file storage and retrieval\n- AWS SDK (@aws-sdk/client-s3, @aws-sdk/s3-presigned-post, @aws-sdk/s3-request-presigner) for S3 operations\n\n**Database**:\n- PostgreSQL (recommended: Neon serverless or similar)\n- Connection via DATABASE_URL environment variable\n\n**Authentication**:\n- JWT tokens with configurable expiration (default 24 hours)\n- SECRET_KEY for token signing (must be set in production)\n\n**Frontend Libraries**:\n- Radix UI primitives for accessible component foundation\n- React Query for efficient data synchronization\n- React Dropzone for drag-and-drop file uploads\n- Lucide React for consistent iconography\n\n**Development Tools**:\n- TypeScript for type safety across frontend and shared schemas\n- ESLint and Prettier for code quality (implied by tooling setup)\n- Replit-specific plugins for development experience (@replit/vite-plugin-*)\n\n**Required Environment Variables**:\n- `DATABASE_URL` - PostgreSQL connection string\n- `SECRET_KEY` - JWT signing key\n- `AWS_ACCESS_KEY_ID` - AWS credentials\n- `AWS_SECRET_ACCESS_KEY` - AWS credentials\n- `AWS_REGION` - AWS region (e.g., us-east-1)\n- `S3_BUCKET_NAME` - S3 bucket for file storage\n\n**API Integration Pattern**: Frontend uses a centralized API client with fetch-based requests, credential inclusion for session cookies, and standardized error handling. The queryClient provides caching and automatic refetching with configurable unauthorized behavior.\n\n## Recent Changes\n\n### October 30, 2025\n- **GitHub Import Complete**: Successfully imported and configured EnlitEDU SFTP application for Replit environment\n- **Environment Setup**: Configured all required secrets (DATABASE_URL, SECRET_KEY, AWS credentials, S3_BUCKET_NAME)\n- **Dependencies**: Installed Node.js and Python dependencies via npm and uv\n- **Workflow Configuration**: Set up \"EnlitEDU SFTP App\" workflow running on port 5000 with webview output\n- **Database Initialization**: Database tables created and seeded with default admin user (admin/admin123)\n- **Frontend Build**: Vite configured with allowedHosts: true for Replit proxy compatibility\n- **Backend Server**: FastAPI running on 0.0.0.0:5000 serving both API and built React frontend\n- **Header Component**: Fixed logout functionality to use api.logout() method and redirect to /login\n- **Deployment Config**: Configured autoscale deployment with proper build and run commands\n- **Hybrid File Listing**: Implemented complete S3 bucket visibility showing all files (both database-tracked and external S3 files)\n- **Folder Management**: Added folder creation, viewing, and navigation with breadcrumb trails\n- **Folder Sentinels**: Implemented `.keep` file strategy to mark empty folders in S3 while filtering them from user view\n- **Admin Panel Fix**: Resolved 307 redirect errors by adding both \"/\" and \"\" route variants for users and roles endpoints\n- **Branding Update**: Added EnlitEDU logo throughout application (landing page, login, dashboard)\n- **UI Enhancements**: Folder icons, clickable folder cards, and improved visual hierarchy for file/folder distinction\n- **User Management**: Admin panel includes role assignment during user creation with multi-select checkboxes\n- **Share Links**: 12-hour maximum expiration enforced on file sharing with S3 presigned URLs (not Replit URLs)\n- **S3 Listing Fix (v2)**: Fixed S3 service to properly return CommonPrefixes with 'Prefix' field intact, allowing folder detection logic to distinguish between folders and files. All S3 folders now display correctly at root and subfolder levels.\n- **Edit User Feature**: Added Edit User functionality in Admin Panel with role assignment checkboxes for existing users, allowing admins to update user roles and email\n- **Logo Display Fix**: Converted logo references from public folder paths to Vite asset imports (`import enlitEduLogo from '../assets/enlitedu-logo.png'`). Vite now properly processes and hashes the logo for reliable browser display. Applied to Dashboard, LoginPage, and Landing pages.\n- **Upload Refresh Fix**: Resolved file upload UI refresh issue (root cause was S3 listing bug not showing newly uploaded files)\n- **File Naming Convention**: UUID prefixes in S3 keys (e.g., `{uuid}_{filename}`) are intentional to prevent filename conflicts. Users see and download files with original names; UUID only exists in backend S3 storage.\n- **Landing Page Redesign**: Complete UI overhaul matching user-provided design mockups with hero section (gradient heading, CTA buttons), 4-feature grid (Easy Upload, Secure Storage, Fast Access, Easy Sharing), and bottom CTA section\n- **Layout Component System**: Created reusable Layout, Header, and Footer components for consistent branding across all pages (landing, login, dashboard, admin panel)\n- **Routing Update**: Separated marketing (/) from authentication (/login) to provide clear user journey from landing page to login to dashboard\n- **Auth Flow Fix**: Corrected all logout and session-expired redirects to point to /login instead of / to maintain proper authentication flow without confusing users with marketing content\n- **Header Authentication Fix**: Updated Header component to properly fetch user data using JWT token from localStorage via api.getCurrentUser() instead of session cookies\n- **Header Visibility Control**: Added conditional rendering so header user info (welcome message, username, buttons) only displays on authenticated pages, not on login/landing pages\n- **Admin Button Logic Fix**: Corrected admin detection to use `user?.is_admin === true` instead of non-existent `user?.role === 'admin'`, ensuring only actual admin users see the Admin button\n- **Login Form Enhancement**: Added autocomplete=\"username\" and autocomplete=\"current-password\" attributes to login form inputs for better browser compatibility\n- **Upload Success Message**: Fixed FileUploadDialog to show \"Completed\" in green text when file upload succeeds, replacing generic error messages","size_bytes":10748},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"bcrypt>=5.0.0\",\n    \"boto3>=1.40.62\",\n    \"fastapi>=0.120.2\",\n    \"passlib>=1.7.4\",\n    \"psycopg2-binary>=2.9.11\",\n    \"pydantic>=2.12.3\",\n    \"pydantic-settings>=2.11.0\",\n    \"python-dotenv>=1.2.1\",\n    \"python-jose>=3.5.0\",\n    \"python-multipart>=0.0.20\",\n    \"sqlalchemy>=2.0.44\",\n    \"uvicorn>=0.38.0\",\n]\n","size_bytes":456},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"backend/database/db.py":{"content":"from sqlalchemy import create_engine\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm import sessionmaker\nfrom sqlalchemy.pool import NullPool\nfrom backend.config import settings\n\n# Add connection pooling settings to prevent SSL connection issues\nengine = create_engine(\n    settings.DATABASE_URL,\n    pool_pre_ping=True,  # Verify connections before using them\n    pool_recycle=300,    # Recycle connections after 5 minutes\n    connect_args={\n        \"connect_timeout\": 10,\n        \"keepalives\": 1,\n        \"keepalives_idle\": 30,\n        \"keepalives_interval\": 10,\n        \"keepalives_count\": 5,\n    }\n)\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\nBase = declarative_base()\n\ndef get_db():\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n\ndef init_db():\n    Base.metadata.create_all(bind=engine)\n","size_bytes":889},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":116},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/App.tsx":{"content":"\nimport { Switch, Route, Redirect } from \"wouter\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { ThemeProvider } from \"next-themes\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { Toaster } from \"./components/ui/toaster\";\nimport Landing from \"./pages/landing\";\nimport { LoginPage } from \"./pages/LoginPage\";\nimport { Dashboard } from \"./pages/Dashboard\";\nimport { AdminPanel } from \"./pages/AdminPanel\";\n\nfunction ProtectedRoute({ component: Component, requireAdmin = false }: { component: React.ComponentType; requireAdmin?: boolean }) {\n  const isAuthenticated = !!localStorage.getItem('access_token');\n\n  if (!isAuthenticated) {\n    localStorage.removeItem('user');\n    localStorage.removeItem('access_token');\n    return <Redirect to=\"/login\" />;\n  }\n\n  if (requireAdmin) {\n    const userStr = localStorage.getItem('user');\n    if (userStr) {\n      try {\n        const user = JSON.parse(userStr);\n        if (!user.is_admin) {\n          return <Redirect to=\"/dashboard\" />;\n        }\n      } catch (error) {\n        console.error('Failed to parse user data:', error);\n        localStorage.removeItem('user');\n        localStorage.removeItem('access_token');\n        return <Redirect to=\"/login\" />;\n      }\n    }\n  }\n\n  return <Component />;\n}\n\nfunction App() {\n  return (\n    <ThemeProvider attribute=\"class\" defaultTheme=\"light\" enableSystem={false}>\n      <QueryClientProvider client={queryClient}>\n        <Switch>\n          <Route path=\"/\" component={Landing} />\n          <Route path=\"/login\" component={LoginPage} />\n          <Route path=\"/dashboard\">\n            {() => <ProtectedRoute component={Dashboard} />}\n          </Route>\n          <Route path=\"/admin\">\n            {() => <ProtectedRoute component={AdminPanel} requireAdmin={true} />}\n          </Route>\n          <Route>\n            {() => {\n              const isAuthenticated = !!localStorage.getItem('access_token');\n              return <Redirect to={isAuthenticated ? \"/dashboard\" : \"/login\"} />;\n            }}\n          </Route>\n        </Switch>\n        <Toaster />\n      </QueryClientProvider>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2161},"README.md":{"content":"# EnlitEDU SFTP Application\n\nA secure file transfer and management system built with FastAPI (Python) and React.\n\n## Features\n\n- **User Authentication** - Secure login system with JWT tokens\n- **Role-Based Access Control** - Admin, Editor, Viewer, and Contributor roles\n- **File Management** - Upload, download, copy, and delete files\n- **S3 Integration** - Secure file storage using AWS S3\n- **File Sharing** - Generate temporary share links with expiration\n- **Admin Panel** - Manage users and roles\n\n## Technology Stack\n\n### Backend\n- FastAPI (Python)\n- PostgreSQL\n- SQLAlchemy ORM\n- AWS S3 for file storage\n- JWT authentication\n\n### Frontend\n- React with TypeScript\n- Vite\n- TailwindCSS\n- shadcn/ui components\n- React Query for data fetching\n\n## Setup\n\n### Prerequisites\n- Python 3.11+\n- PostgreSQL database\n- AWS S3 bucket and credentials\n\n### Environment Variables\n\nSet the following environment variables in your Repl Secrets:\n\n- `DATABASE_URL` - PostgreSQL connection string\n- `SECRET_KEY` - JWT secret key\n- `AWS_ACCESS_KEY_ID` - AWS access key\n- `AWS_SECRET_ACCESS_KEY` - AWS secret key\n- `AWS_REGION` - AWS region (e.g., us-east-1)\n- `S3_BUCKET_NAME` - S3 bucket name\n\n### Running the Application\n\n1. **Initialize the database**:\n   ```bash\n   python backend/init_db.py\n   ```\n\n2. **Start the application**:\n   The application will start automatically when you click the Run button, or run:\n   ```bash\n   python -m uvicorn backend.main:app --host 0.0.0.0 --port 5000 --reload\n   ```\n\n3. **Access the application**:\n   - Open your browser to the Replit web view\n   - Default admin credentials:\n     - Username: `admin`\n     - Password: `admin123`\n\n    **IMPORTANT**: Change the admin password after first login!\n\n## Default Roles\n\nThe system comes with 4 pre-configured roles:\n\n- **Admin** - Full access to all features\n- **Editor** - Can read, write, and share files\n- **Viewer** - Can only view files\n- **Contributor** - Can read, write, and copy files\n\n## API Documentation\n\nOnce the backend is running, visit `/docs` for interactive API documentation powered by FastAPI's built-in Swagger UI.\n\n## Admin Features\n\nAs an admin user, you can:\n\n- Create and manage user accounts\n- Assign roles to users\n- View all users and their permissions\n- Delete users (except yourself)\n\n## File Operations\n\n### For Users with Write Permission:\n- Upload files via drag-and-drop or file picker\n- Files are securely stored in S3 with unique keys\n\n### For Users with Copy Permission:\n- Copy files to different folders\n- Duplicate files within the same folder\n\n### For Users with Delete Permission:\n- Delete individual files\n- Bulk delete multiple files\n\n### For Users with Share Permission:\n- Generate temporary share links\n- Set expiration time (1-168 hours)\n- Set maximum download limits","size_bytes":2790},"backend/__init__.py":{"content":"# Backend package\n","size_bytes":18},"client/src/components/ShareLinkDialog.tsx":{"content":"import { useState } from 'react';\nimport { api } from '../api/api';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from './ui/dialog';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';\nimport { Copy, CheckCircle2 } from 'lucide-react';\nimport { useToast } from '../hooks/use-toast';\n\ninterface ShareLinkDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  fileId: number;\n}\n\nexport function ShareLinkDialog({ open, onOpenChange, fileId }: ShareLinkDialogProps) {\n  const { toast } = useToast();\n  const [shareUrl, setShareUrl] = useState('');\n  const [expiresIn, setExpiresIn] = useState('24');\n  const [loading, setLoading] = useState(false);\n  const [copied, setCopied] = useState(false);\n\n  const generateLink = async () => {\n    setLoading(true);\n    try {\n      const data = await api.createShareLink(fileId, parseInt(expiresIn));\n      // Use the presigned URL directly from S3\n      setShareUrl(data.share_url);\n      toast({\n        title: 'Success',\n        description: 'Share link created successfully',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to create share link',\n        variant: 'destructive',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const copyToClipboard = async () => {\n    try {\n      // Try modern clipboard API first\n      if (navigator.clipboard && navigator.clipboard.writeText) {\n        await navigator.clipboard.writeText(shareUrl);\n        setCopied(true);\n        toast({\n          title: 'Copied',\n          description: 'Share link copied to clipboard',\n        });\n        setTimeout(() => setCopied(false), 2000);\n      } else {\n        // Fallback to legacy method\n        const textArea = document.createElement('textarea');\n        textArea.value = shareUrl;\n        textArea.style.position = 'fixed';\n        textArea.style.left = '-9999px';\n        document.body.appendChild(textArea);\n        textArea.focus();\n        textArea.select();\n        \n        try {\n          const successful = document.execCommand('copy');\n          document.body.removeChild(textArea);\n          \n          if (successful) {\n            setCopied(true);\n            toast({\n              title: 'Copied',\n              description: 'Share link copied to clipboard',\n            });\n            setTimeout(() => setCopied(false), 2000);\n          } else {\n            throw new Error('Copy command failed');\n          }\n        } catch (err) {\n          document.body.removeChild(textArea);\n          throw err;\n        }\n      }\n    } catch (error) {\n      console.error('Copy failed:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to copy link. Please copy manually.',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleClose = () => {\n    setShareUrl('');\n    setCopied(false);\n    onOpenChange(false);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"dark:bg-gray-900 dark:border-gray-800\">\n        <DialogHeader>\n          <DialogTitle className=\"dark:text-gray-100\">Share File</DialogTitle>\n          <DialogDescription className=\"dark:text-gray-400\">\n            Create a temporary download link that expires after the selected time\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <label className=\"text-sm font-medium dark:text-gray-200\">Link expires in</label>\n            <Select value={expiresIn} onValueChange={setExpiresIn}>\n              <SelectTrigger className=\"dark:bg-gray-900 dark:border-gray-700\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent className=\"dark:bg-gray-900 dark:border-gray-700\">\n                <SelectItem value=\"1\">1 hour</SelectItem>\n                <SelectItem value=\"3\">3 hours</SelectItem>\n                <SelectItem value=\"6\">6 hours</SelectItem>\n                <SelectItem value=\"12\">12 hours</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {shareUrl ? (\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">Share Link</label>\n              <div className=\"flex space-x-2\">\n                <Input \n                  value={shareUrl} \n                  readOnly \n                  className=\"font-mono text-sm dark:bg-gray-900 dark:border-gray-700\" \n                  onClick={(e) => {\n                    e.currentTarget.select();\n                  }}\n                />\n                <Button variant=\"outline\" onClick={copyToClipboard}>\n                  {copied ? <CheckCircle2 className=\"w-4 h-4 text-green-600\" /> : <Copy className=\"w-4 h-4\" />}\n                </Button>\n              </div>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                This link will expire in {expiresIn} hour{expiresIn !== '1' ? 's' : ''}. Click the text to select and copy manually.\n              </p>\n            </div>\n          ) : (\n            <Button onClick={generateLink} disabled={loading} className=\"w-full\">\n              {loading ? 'Generating...' : 'Generate Share Link'}\n            </Button>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":5442},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/pages/Dashboard.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useLocation } from 'wouter';\nimport { api, type FileItem, type User } from '../api/api';\nimport { Button } from '../components/ui/button';\nimport { Card } from '../components/ui/card';\nimport { Input } from '../components/ui/input';\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '../components/ui/dialog';\nimport { \n  Upload, \n  FolderPlus, \n  LogOut, \n  Settings, \n  File, \n  Download,\n  Trash2,\n  Copy,\n  Share2,\n  Users,\n  Folder,\n  ChevronRight,\n  Home,\n  Search,\n  X,\n  Grid3x3,\n  List\n} from 'lucide-react';\nimport { FileUploadDialog } from '../components/FileUploadDialog';\nimport { ShareLinkDialog } from '../components/ShareLinkDialog';\nimport { useToast } from '../hooks/use-toast';\nimport { useQuery } from '@tanstack/react-query';\nimport { RefreshCw } from 'lucide-react';\nimport { cn } from '../lib/utils';\nimport { Layout } from '../components/Layout';\nimport { Header } from '../components/Header'; // Assuming Header component is in ../components/Header\n\nexport function Dashboard() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [user, setUser] = useState<User | null>(null);\n  const [files, setFiles] = useState<FileItem[]>([]);\n  const [selectedFiles, setSelectedFiles] = useState<Set<number>>(new Set());\n  const [loading, setLoading] = useState(true);\n  const [uploadDialogOpen, setUploadDialogOpen] = useState(false);\n  const [shareDialogOpen, setShareDialogOpen] = useState(false);\n  const [shareFileId, setShareFileId] = useState<number | null>(null);\n  const [currentFolder, setCurrentFolder] = useState('/');\n  const [createFolderDialogOpen, setCreateFolderDialogOpen] = useState(false);\n  const [newFolderName, setNewFolderName] = useState('');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n\n  const loadData = async (retryCount = 0) => {\n    try {\n      const [userData, filesData] = await Promise.all([\n        api.getCurrentUser(),\n        api.getFiles(currentFolder),\n      ]);\n      setUser(userData);\n      setFiles(filesData);\n      setLoading(false);\n      return userData; // Return userData for potential use in Header\n    } catch (error) {\n      console.error('Error loading data:', error);\n\n      const errorMessage = error instanceof Error ? error.message : '';\n      const isJsonError = errorMessage.includes('Unexpected token') || \n                         errorMessage.includes('is not valid JSON');\n\n      if (retryCount < 2 && (\n          errorMessage.includes('Network error') || \n          errorMessage.includes('Failed to fetch') ||\n          isJsonError\n      )) {\n        console.log(`Retrying... (attempt ${retryCount + 1})`);\n        setTimeout(() => loadData(retryCount + 1), 1500);\n        return null;\n      }\n\n      if (errorMessage.includes('Session expired') || errorMessage.includes('401')) {\n        toast({\n          title: 'Session Expired',\n          description: 'Please login again.',\n          variant: 'destructive',\n        });\n        setLocation('/login');\n      } else if (isJsonError) {\n        toast({\n          title: 'Connection Error',\n          description: 'Unable to connect to the API. Please try refreshing the page.',\n          variant: 'destructive',\n        });\n        setLoading(false);\n      } else {\n        toast({\n          title: 'Error',\n          description: errorMessage || 'Failed to load data.',\n          variant: 'destructive',\n        });\n        setLoading(false);\n      }\n      return null;\n    }\n  };\n\n  useEffect(() => {\n    loadData();\n  }, [currentFolder]);\n\n  const handleLogout = () => {\n    api.logout();\n    setLocation('/login');\n  };\n\n  const handleDownload = async (file: FileItem) => {\n    try {\n      let download_url: string;\n\n      if (file.id !== null) {\n        const result = await api.getDownloadUrl(file.id);\n        download_url = result.download_url;\n      } else {\n        const result = await api.getDownloadUrlByKey(file.s3_key);\n        download_url = result.download_url;\n      }\n\n      window.open(download_url, '_blank');\n      toast({\n        title: 'Success',\n        description: 'File download started',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to download file',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleDelete = async (file: any) => {\n    if (!confirm('Are you sure you want to delete this file?')) return;\n\n    try {\n      if (file.id !== null) {\n        await api.deleteFile(file.id);\n      } else {\n        await api.deleteFileByKey(file.s3_key);\n      }\n      setFiles(files.filter(f => f.s3_key !== file.s3_key));\n      toast({\n        title: 'Success',\n        description: 'File deleted successfully',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to delete file',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleBulkDelete = async () => {\n    if (selectedFiles.size === 0) return;\n    if (!confirm(`Delete ${selectedFiles.size} file(s)?`)) return;\n\n    try {\n      await api.bulkDeleteFiles(Array.from(selectedFiles));\n      setFiles(files.filter(f => !selectedFiles.has(f.id)));\n      setSelectedFiles(new Set());\n      toast({\n        title: 'Success',\n        description: `Deleted ${selectedFiles.size} file(s)`,\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to delete files',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleShare = (fileId: number) => {\n    setShareFileId(fileId);\n    setShareDialogOpen(true);\n  };\n\n  const handleFolderClick = (folderPath: string) => {\n    setCurrentFolder(folderPath);\n    setSelectedFiles(new Set());\n  };\n\n  const handleCreateFolder = async () => {\n    if (!newFolderName.trim()) return;\n\n    try {\n      await api.createFolder(newFolderName, currentFolder);\n      setNewFolderName('');\n      setCreateFolderDialogOpen(false);\n      await loadData();\n      toast({\n        title: 'Success',\n        description: `Folder \"${newFolderName}\" created successfully`,\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: error instanceof Error ? error.message : 'Failed to create folder',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const getBreadcrumbs = () => {\n    const parts = currentFolder.split('/').filter(p => p);\n    const breadcrumbs = [{ name: 'Root', path: '/' }];\n    let path = '';\n\n    for (const part of parts) {\n      path += `/${part}`;\n      breadcrumbs.push({ name: part, path });\n    }\n\n    return breadcrumbs;\n  };\n\n  const canWrite = user?.is_admin || user?.roles.some(r => r.can_write);\n  const canDelete = user?.is_admin || user?.roles.some(r => r.can_delete);\n  const canShare = user?.is_admin || user?.roles.some(r => r.can_share);\n\n  // Filter files based on search query\n  const filteredFiles = files.filter(item => \n    item.filename.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  console.log('User permissions:', { \n    user: user?.username, \n    isAdmin: user?.is_admin, \n    roles: user?.roles,\n    canWrite, \n    canDelete, \n    canShare \n  });\n\n  if (loading) {\n    return (\n      <Layout>\n        <div className=\"min-h-[calc(100vh-8rem)] flex items-center justify-center\">\n          <div className=\"text-lg\">Loading...</div>\n        </div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <div className=\"bg-gray-50 dark:bg-gray-950 min-h-[calc(100vh-8rem)]\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Breadcrumb Navigation */}\n        <div className=\"mb-4 flex items-center text-sm text-gray-600 dark:text-gray-400\">\n          {getBreadcrumbs().map((crumb, index, array) => (\n            <div key={crumb.path} className=\"flex items-center\">\n              <button\n                onClick={() => handleFolderClick(crumb.path)}\n                className=\"hover:text-blue-600 flex items-center\"\n              >\n                {index === 0 ? <Home className=\"w-4 h-4 mr-1\" /> : null}\n                {crumb.name}\n              </button>\n              {index < array.length - 1 && <ChevronRight className=\"w-4 h-4 mx-2\" />}\n            </div>\n          ))}\n        </div>\n\n        <div className=\"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">My Files</h2>\n          \n          {/* Search Bar */}\n          <div className=\"relative w-full sm:w-64\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n            <Input\n              type=\"text\"\n              placeholder=\"Search files and folders...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10 pr-10 dark:bg-gray-900 dark:border-gray-700\"\n            />\n            {searchQuery && (\n              <button\n                onClick={() => setSearchQuery('')}\n                className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200\"\n              >\n                <X className=\"w-4 h-4\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        <div className=\"mb-4 flex justify-between items-center\">\n          {/* View Mode Toggle */}\n          <div className=\"flex gap-1 border border-gray-200 dark:border-gray-700 rounded-md p-1\">\n            <Button\n              variant={viewMode === 'grid' ? 'default' : 'ghost'}\n              size=\"sm\"\n              onClick={() => setViewMode('grid')}\n              className=\"gap-2\"\n            >\n              <Grid3x3 className=\"w-4 h-4\" />\n              Grid\n            </Button>\n            <Button\n              variant={viewMode === 'list' ? 'default' : 'ghost'}\n              size=\"sm\"\n              onClick={() => setViewMode('list')}\n              className=\"gap-2\"\n            >\n              <List className=\"w-4 h-4\" />\n              List\n            </Button>\n          </div>\n\n          <div className=\"flex space-x-2\">\n            <Button \n              variant=\"outline\" \n              size=\"sm\"\n              onClick={async () => {\n                setLoading(true);\n                await loadData(); // Await loadData to ensure it completes before setting loading to false\n              }}\n              disabled={loading}\n            >\n              <RefreshCw className={cn(\"w-4 h-4 mr-2\", loading && \"animate-spin\")} />\n              Refresh\n            </Button>\n            {canWrite && (\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={() => setCreateFolderDialogOpen(true)}\n              >\n                <FolderPlus className=\"w-4 h-4 mr-2\" />\n                New Folder\n              </Button>\n            )}\n            {selectedFiles.size > 0 && canDelete && (\n              <Button variant=\"destructive\" size=\"sm\" onClick={handleBulkDelete}>\n                <Trash2 className=\"w-4 h-4 mr-2\" />\n                Delete ({selectedFiles.size})\n              </Button>\n            )}\n            <Button \n              onClick={() => setUploadDialogOpen(true)}\n              disabled={!canWrite}\n              title={!canWrite ? \"You don't have upload permissions. Contact an administrator.\" : \"Upload files to your storage\"}\n            >\n              <Upload className=\"w-4 h-4 mr-2\" />\n              Upload Files\n            </Button>\n          </div>\n        </div>\n\n        {filteredFiles.length === 0 && searchQuery ? (\n          <Card className=\"p-12 text-center dark:bg-gray-900 dark:border-gray-800\">\n            <Search className=\"w-16 h-16 mx-auto text-gray-400 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">No files found</h3>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-4\">No files or folders match \"{searchQuery}\"</p>\n            <Button variant=\"outline\" onClick={() => setSearchQuery('')}>\n              Clear Search\n            </Button>\n          </Card>\n        ) : files.length === 0 ? (\n          <Card className=\"p-12 text-center dark:bg-gray-900 dark:border-gray-800\">\n            <File className=\"w-16 h-16 mx-auto text-gray-400 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">No files yet</h3>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-4\">Upload your first file to get started</p>\n            {canWrite && (\n              <Button onClick={() => setUploadDialogOpen(true)}>\n                <Upload className=\"w-4 h-4 mr-2\" />\n                Upload Files\n              </Button>\n            )}\n          </Card>\n        ) : viewMode === 'grid' ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {filteredFiles.map((item) => (\n              <Card \n                key={item.s3_key || item.filename} \n                className={`p-4 dark:bg-gray-900 dark:border-gray-800 ${item.type === 'folder' ? 'cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800' : ''}`}\n                onClick={() => item.type === 'folder' ? handleFolderClick(item.folder_path) : null}\n              >\n                <div className=\"flex items-start justify-between mb-2\">\n                  <div className=\"flex items-center\">\n                    {item.type === 'file' && item.id !== null && (\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedFiles.has(item.id)}\n                        onChange={(e) => {\n                          e.stopPropagation();\n                          const newSelected = new Set(selectedFiles);\n                          if (e.target.checked) {\n                            newSelected.add(item.id);\n                          } else {\n                            newSelected.delete(item.id);\n                          }\n                          setSelectedFiles(newSelected);\n                        }}\n                        className=\"mr-3\"\n                        onClick={(e) => e.stopPropagation()}\n                      />\n                    )}\n                    {item.type === 'folder' ? (\n                      <Folder className=\"w-5 h-5 text-yellow-600\" />\n                    ) : (\n                      <File className=\"w-5 h-5 text-blue-500\" />\n                    )}\n                  </div>\n                  {item.type === 'file' && item.id === null && (\n                    <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded\">External</span>\n                  )}\n                </div>\n                <h3 className=\"font-medium text-gray-900 dark:text-gray-100 truncate mb-1\">{item.filename}</h3>\n                {item.type === 'file' ? (\n                  <>\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-3\">\n                      {item.file_size ? `${(item.file_size / 1024).toFixed(1)} KB` : 'Unknown size'}\n                      {'  '}\n                      {item.uploaded_at ? new Date(item.uploaded_at).toLocaleDateString() : 'Unknown date'}\n                      {item.owner_username && (\n                        <>\n                          {'  '}\n                          <span className=\"text-gray-600 dark:text-gray-400\">{item.owner_username}</span>\n                        </>\n                      )}\n                    </p>\n                    <div className=\"flex space-x-2\" onClick={(e) => e.stopPropagation()}>\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => handleDownload(item)}>\n                        <Download className=\"w-3 h-3\" />\n                      </Button>\n                      {canShare && item.id !== null && (\n                        <Button size=\"sm\" variant=\"outline\" onClick={() => handleShare(item.id)}>\n                          <Share2 className=\"w-3 h-3\" />\n                        </Button>\n                      )}\n                      {canDelete && (\n                        <Button \n                          size=\"sm\" \n                          variant=\"outline\" \n                          onClick={() => handleDelete(item)}\n                          className=\"text-red-600 hover:text-red-700 dark:text-red-400\"\n                        >\n                          <Trash2 className=\"w-3 h-3\" />\n                        </Button>\n                      )}\n                    </div>\n                  </>\n                ) : (\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-3\">Folder</p>\n                )}\n              </Card>\n            ))}\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {filteredFiles.map((item) => (\n              <Card \n                key={item.s3_key || item.filename} \n                className={`p-4 dark:bg-gray-900 dark:border-gray-800 ${item.type === 'folder' ? 'cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800' : ''}`}\n                onClick={() => item.type === 'folder' ? handleFolderClick(item.folder_path) : null}\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-4 flex-1\">\n                    <div className=\"flex items-center gap-3\">\n                      {item.type === 'file' && item.id !== null && (\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedFiles.has(item.id)}\n                          onChange={(e) => {\n                            e.stopPropagation();\n                            const newSelected = new Set(selectedFiles);\n                            if (e.target.checked) {\n                              newSelected.add(item.id);\n                            } else {\n                              newSelected.delete(item.id);\n                            }\n                            setSelectedFiles(newSelected);\n                          }}\n                          onClick={(e) => e.stopPropagation()}\n                        />\n                      )}\n                      {item.type === 'folder' ? (\n                        <Folder className=\"w-5 h-5 text-yellow-600\" />\n                      ) : (\n                        <File className=\"w-5 h-5 text-blue-500\" />\n                      )}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-medium text-gray-900 dark:text-gray-100 truncate\">{item.filename}</h3>\n                      {item.type === 'file' && (\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                          {item.file_size ? `${(item.file_size / 1024).toFixed(1)} KB` : 'Unknown size'}\n                          {'  '}\n                          {item.uploaded_at ? new Date(item.uploaded_at).toLocaleDateString() : 'Unknown date'}\n                          {item.owner_username && (\n                            <>\n                              {'  '}\n                              <span className=\"text-gray-600 dark:text-gray-400\">{item.owner_username}</span>\n                            </>\n                          )}\n                        </p>\n                      )}\n                      {item.type === 'folder' && (\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400\">Folder</p>\n                      )}\n                    </div>\n                    {item.type === 'file' && item.id === null && (\n                      <span className=\"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded\">External</span>\n                    )}\n                  </div>\n                  {item.type === 'file' && (\n                    <div className=\"flex space-x-2\" onClick={(e) => e.stopPropagation()}>\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => handleDownload(item)}>\n                        <Download className=\"w-3 h-3\" />\n                      </Button>\n                      {canShare && item.id !== null && (\n                        <Button size=\"sm\" variant=\"outline\" onClick={() => handleShare(item.id)}>\n                          <Share2 className=\"w-3 h-3\" />\n                        </Button>\n                      )}\n                      {canDelete && (\n                        <Button \n                          size=\"sm\" \n                          variant=\"outline\" \n                          onClick={() => handleDelete(item)}\n                          className=\"text-red-600 hover:text-red-700 dark:text-red-400\"\n                        >\n                          <Trash2 className=\"w-3 h-3\" />\n                        </Button>\n                      )}\n                    </div>\n                  )}\n                </div>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <FileUploadDialog \n        open={uploadDialogOpen} \n        onOpenChange={setUploadDialogOpen}\n        currentFolder={currentFolder}\n        onSuccess={() => {\n          loadData();\n          setUploadDialogOpen(false);\n        }}\n      />\n\n      {shareFileId && (\n        <ShareLinkDialog\n          open={shareDialogOpen}\n          onOpenChange={setShareDialogOpen}\n          fileId={shareFileId}\n        />\n      )}\n\n      {/* Create Folder Dialog */}\n      <Dialog open={createFolderDialogOpen} onOpenChange={setCreateFolderDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Create New Folder</DialogTitle>\n            <DialogDescription>\n              Enter a name for the new folder in {currentFolder}\n            </DialogDescription>\n          </DialogHeader>\n          <Input\n            placeholder=\"Folder name\"\n            value={newFolderName}\n            onChange={(e) => setNewFolderName(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter') {\n                handleCreateFolder();\n              }\n            }}\n          />\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setCreateFolderDialogOpen(false)}>\n              Cancel\n            </Button>\n            <Button onClick={handleCreateFolder} disabled={!newFolderName.trim()}>\n              Create Folder\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n      </div>\n    </Layout>\n  );\n}","size_bytes":22544},"client/src/components/Footer.tsx":{"content":"export function Footer() {\n  return (\n    <footer className=\"border-t border-gray-200 dark:border-gray-700 py-8 px-4 sm:px-6 lg:px-8 bg-white dark:bg-gray-900 mt-auto\">\n      <div className=\"max-w-7xl mx-auto text-center text-sm text-gray-600 dark:text-gray-400\">\n        <p>&copy; {new Date().getFullYear()} EnlitEDU. All rights reserved.</p>\n      </div>\n    </footer>\n  );\n}\n","size_bytes":378},"backend/database/__init__.py":{"content":"# Database package\n","size_bytes":19},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading, error } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    error,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":325},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/api/api.ts":{"content":"const API_BASE_URL = '/api';\n\nexport interface LoginCredentials {\n  username: string;\n  password: string;\n}\n\nexport interface User {\n  id: number;\n  username: string;\n  email: string | null;\n  is_admin: boolean;\n  is_active: boolean;\n  roles: Role[];\n}\n\nexport interface Role {\n  id: number;\n  name: string;\n  description?: string;\n  can_read: boolean;\n  can_write: boolean;\n  can_copy: boolean;\n  can_delete: boolean;\n  can_share: boolean;\n}\n\nexport interface FileItem {\n  id: number | null;\n  filename: string;\n  s3_key: string | null;\n  file_size: number | null;\n  content_type: string | null;\n  folder_path: string;\n  uploaded_at: string | null;\n  owner_username: string | null;\n  type: \"file\" | \"folder\";\n}\n\nexport interface UploadUrlResponse {\n  file_id: number;\n  upload_url: string;\n  upload_fields: Record<string, string>;\n  s3_key: string;\n}\n\nexport interface ShareLinkResponse {\n  share_token: string;\n  expires_at: string;\n  share_url: string;\n}\n\nclass ApiClient {\n  private token: string | null = null;\n\n  constructor() {\n    this.token = localStorage.getItem('access_token');\n  }\n\n  private getHeaders(): Headers {\n    this.checkTokenExpiry();\n\n    const headers = new Headers({\n      'Content-Type': 'application/json',\n    });\n\n    if (this.token) {\n      headers.append('Authorization', `Bearer ${this.token}`);\n    }\n\n    return headers;\n  }\n\n  private decodeToken(token: string): any {\n    try {\n      const payload = JSON.parse(atob(token.split('.')[1]));\n      return payload;\n    } catch {\n      return null;\n    }\n  }\n\n  private isTokenExpired(token: string): boolean {\n    const payload = this.decodeToken(token);\n    if (!payload || !payload.exp) return true;\n    return Date.now() >= payload.exp * 1000;\n  }\n\n  async login(credentials: LoginCredentials) {\n    const response = await fetch(`${API_BASE_URL}/auth/login`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(credentials),\n    });\n\n    if (!response.ok) {\n      let errorMessage = 'Login failed';\n      try {\n        const error = await response.json();\n        errorMessage = error.detail || errorMessage;\n      } catch {\n        // If response is not JSON (e.g., HTML error page), use status text\n        errorMessage = `Server error: ${response.statusText || 'Please try again'}`;\n      }\n      throw new Error(errorMessage);\n    }\n\n    const data = await response.json();\n    this.token = data.access_token;\n    localStorage.setItem('access_token', data.access_token);\n    localStorage.setItem('user', JSON.stringify(data.user));\n\n    return data;\n  }\n\n  private checkTokenExpiry(): void {\n    if (this.token && this.isTokenExpired(this.token)) {\n      console.warn('Token expired, clearing authentication');\n      this.logout();\n      // Only redirect if not already on login page\n      if (!window.location.pathname.includes('/login')) {\n        window.location.href = '/';\n      }\n    }\n  }\n\n  logout() {\n    this.token = null;\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('user');\n  }\n\n  async getCurrentUser(): Promise<User> {\n    try {\n      const response = await fetch(`${API_BASE_URL}/auth/me`, {\n        headers: this.getHeaders(),\n      });\n\n      if (response.status === 401) {\n        // Token is invalid or expired\n        this.logout();\n        throw new Error('Session expired. Please login again.');\n      }\n\n      if (!response.ok) {\n        throw new Error('Failed to get current user');\n      }\n\n      return response.json();\n    } catch (error) {\n      if (error instanceof TypeError && error.message.includes('Failed to fetch')) {\n        throw new Error('Network error. Please check your connection.');\n      }\n      throw error;\n    }\n  }\n\n  async getFiles(folderPath: string = '/'): Promise<FileItem[]> {\n    try {\n      const response = await fetch(`${API_BASE_URL}/files?folder_path=${encodeURIComponent(folderPath)}`, {\n        headers: this.getHeaders(),\n      });\n\n      if (response.status === 401) {\n        this.logout();\n        throw new Error('Session expired. Please login again.');\n      }\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch files');\n      }\n\n      return response.json();\n    } catch (error) {\n      if (error instanceof TypeError && error.message.includes('Failed to fetch')) {\n        throw new Error('Network error. Please check your connection.');\n      }\n      throw error;\n    }\n  }\n\n  async getUploadUrl(filename: string, contentType: string, folderPath: string = '/'): Promise<UploadUrlResponse> {\n    const response = await fetch(`${API_BASE_URL}/files/upload-url`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify({ filename, content_type: contentType, folder_path: folderPath }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Failed to get upload URL');\n    }\n\n    return response.json();\n  }\n\n  async uploadFile(file: File, uploadUrl: string, uploadFields: Record<string, string>) {\n    const formData = new FormData();\n\n    Object.entries(uploadFields).forEach(([key, value]) => {\n      formData.append(key, value);\n    });\n\n    formData.append('file', file);\n\n    try {\n      const response = await fetch(uploadUrl, {\n        method: 'POST',\n        body: formData,\n      });\n\n      // S3 returns 204 No Content on success, which is ok\n      if (!response.ok && response.status !== 204) {\n        const errorText = await response.text();\n        console.error('S3 upload error:', errorText);\n        throw new Error(`Failed to upload file to S3: ${response.status}`);\n      }\n    } catch (error) {\n      // If the error is a network error (CORS), the upload might have actually succeeded\n      if (error instanceof TypeError && error.message.includes('Failed to fetch')) {\n        console.warn('Network error during S3 upload - CORS issue, but file may have uploaded');\n        // Don't throw here - let the completion step verify\n        return;\n      }\n      throw error;\n    }\n  }\n\n  async getDownloadUrl(fileId: number): Promise<{ download_url: string; filename: string }> {\n    const response = await fetch(`${API_BASE_URL}/files/${fileId}/download-url`, {\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to get download URL');\n    }\n\n    return response.json();\n  }\n\n  async getDownloadUrlByKey(s3Key: string): Promise<{ download_url: string; filename: string }> {\n    const response = await fetch(`${API_BASE_URL}/files/download-by-key/${encodeURIComponent(s3Key)}`, {\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to get download URL');\n    }\n\n    return response.json();\n  }\n\n  async deleteFile(fileId: number): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/files/${fileId}`, {\n      method: 'DELETE',\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to delete file');\n    }\n  }\n\n  async deleteFileByKey(s3Key: string): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/files/by-key/${encodeURIComponent(s3Key)}`, {\n      method: 'DELETE',\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to delete file');\n    }\n  }\n\n  async bulkDeleteFiles(fileIds: number[]): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/files/bulk-delete`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify({ file_ids: fileIds }),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to delete files');\n    }\n  }\n\n  async copyFile(fileId: number, destinationFolder: string): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/files/${fileId}/copy`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify({ destination_folder: destinationFolder }),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to copy file');\n    }\n  }\n\n  async createShareLink(fileId: number, expiresInHours: number = 24): Promise<ShareLinkResponse> {\n    const response = await fetch(`${API_BASE_URL}/files/${fileId}/share`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify({ expires_in_hours: expiresInHours }),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to create share link');\n    }\n\n    return response.json();\n  }\n\n  async createFolder(folderName: string, parentFolder: string = '/'): Promise<{ message: string; folder_path: string }> {\n    const response = await fetch(`${API_BASE_URL}/files/create-folder`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify({ folder_name: folderName, parent_folder: parentFolder }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Failed to create folder');\n    }\n\n    return response.json();\n  }\n\n  // Admin endpoints\n  async getUsers(): Promise<User[]> {\n    const response = await fetch(`${API_BASE_URL}/users`, {\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch users');\n    }\n\n    return response.json();\n  }\n\n  async createUser(username: string, password: string, email: string | null, isAdmin: boolean, roleIds: number[]): Promise<User> {\n    const response = await fetch(`${API_BASE_URL}/users/`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify({\n        username,\n        password,\n        email,\n        is_admin: isAdmin,\n        role_ids: roleIds,\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Failed to create user');\n    }\n\n    return response.json();\n  }\n\n  async updateUser(userId: number, data: { email?: string; is_active?: boolean; is_admin?: boolean; role_ids?: number[] }): Promise<User> {\n    const response = await fetch(`${API_BASE_URL}/users/${userId}`, {\n      method: 'PUT',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to update user');\n    }\n\n    return response.json();\n  }\n\n  async deleteUser(userId: number): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/users/${userId}`, {\n      method: 'DELETE',\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to delete user');\n    }\n  }\n\n  async getRoles(): Promise<Role[]> {\n    const response = await fetch(`${API_BASE_URL}/roles`, {\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch roles');\n    }\n\n    return response.json();\n  }\n\n  async createRole(data: { name: string; description?: string; can_read: boolean; can_write: boolean; can_copy: boolean; can_delete: boolean; can_share: boolean }): Promise<Role> {\n    const response = await fetch(`${API_BASE_URL}/roles`, {\n      method: 'POST',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Failed to create role');\n    }\n\n    return response.json();\n  }\n\n  async updateRole(roleId: number, data: Partial<Role>): Promise<Role> {\n    const response = await fetch(`${API_BASE_URL}/roles/${roleId}`, {\n      method: 'PUT',\n      headers: this.getHeaders(),\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to update role');\n    }\n\n    return response.json();\n  }\n\n  async deleteRole(roleId: number): Promise<void> {\n    const response = await fetch(`${API_BASE_URL}/roles/${roleId}`, {\n      method: 'DELETE',\n      headers: this.getHeaders(),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to delete role');\n    }\n  }\n}\n\nexport const api = new ApiClient();","size_bytes":11933},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"shared/schema.ts":{"content":"export interface S3File {\n  id?: string;\n  name: string;\n  key: string;\n  size: number;\n  mimeType: string;\n  lastModified?: Date | string;\n  url?: string;\n  folderId?: string | null;\n  userId?: string;\n}\n\nexport interface PresignedUrl {\n  url: string;\n  fields?: Record<string, string>;\n  key: string;\n}\n\nexport interface ShareLinkResponse {\n  url: string;\n  token: string;\n  expiresAt: Date | string;\n  maxDownloads?: number | null;\n}\n\nexport interface User {\n  id: number | string;\n  email: string;\n  firstName?: string | null;\n  lastName?: string | null;\n  username?: string;\n  isAdmin?: boolean;\n}\n\nexport interface FileMetadata {\n  id: string;\n  name: string;\n  key: string;\n  size: number;\n  mimeType: string;\n  folderId: string | null;\n  userId: string;\n  createdAt: Date | string;\n}\n\nexport interface Folder {\n  id: string;\n  name: string;\n  path: string;\n  parentId: string | null;\n  userId: string;\n  createdAt: Date | string;\n}\n\nexport const uploadRequestSchema = {\n  parse: (data: any) => data,\n  safeParse: (data: any) => ({ success: true, data }),\n};\n\nexport const copyFileSchema = {\n  parse: (data: any) => data,\n  safeParse: (data: any) => ({ success: true, data }),\n};\n\nexport const createShareLinkSchema = {\n  parse: (data: any) => data,\n  safeParse: (data: any) => ({ success: true, data }),\n};\n\nexport const bulkDeleteSchema = {\n  parse: (data: any) => data,\n  safeParse: (data: any) => ({ success: true, data }),\n};\n","size_bytes":1438},"client/src/pages/AdminPanel.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useLocation } from 'wouter';\nimport { api, type User, type Role } from '../api/api';\nimport { Button } from '../components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../components/ui/card';\nimport { Input } from '../components/ui/input';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '../components/ui/dialog';\nimport { ArrowLeft, UserPlus, Shield, Trash2, Edit } from 'lucide-react';\nimport { useToast } from '../hooks/use-toast';\nimport { Layout } from '../components/Layout';\n\nexport function AdminPanel() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [users, setUsers] = useState<User[]>([]);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [createUserOpen, setCreateUserOpen] = useState(false);\n  const [editUserOpen, setEditUserOpen] = useState(false);\n  const [newUser, setNewUser] = useState({ username: '', password: '', email: '', isAdmin: false, roleIds: [] as number[] });\n  const [editUser, setEditUser] = useState<{ id: number; email: string; isAdmin: boolean; roleIds: number[] } | null>(null);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const [usersData, rolesData] = await Promise.all([\n        api.getUsers(),\n        api.getRoles(),\n      ]);\n      setUsers(usersData);\n      setRoles(rolesData);\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to load admin data',\n        variant: 'destructive',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateUser = async () => {\n    try {\n      await api.createUser(newUser.username, newUser.password, newUser.email || null, newUser.isAdmin, newUser.roleIds);\n      setNewUser({ username: '', password: '', email: '', isAdmin: false, roleIds: [] });\n      setCreateUserOpen(false);\n      loadData();\n      toast({\n        title: 'Success',\n        description: 'User created successfully',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: error instanceof Error ? error.message : 'Failed to create user',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleEditUser = (user: User) => {\n    setEditUser({\n      id: user.id,\n      email: user.email || '',\n      isAdmin: user.is_admin,\n      roleIds: user.roles.map(r => r.id),\n    });\n    setEditUserOpen(true);\n  };\n\n  const handleUpdateUser = async () => {\n    if (!editUser) return;\n\n    try {\n      await api.updateUser(editUser.id, {\n        email: editUser.email || undefined,\n        is_admin: editUser.isAdmin,\n        role_ids: editUser.roleIds,\n      });\n      setEditUser(null);\n      setEditUserOpen(false);\n      loadData();\n      toast({\n        title: 'Success',\n        description: 'User updated successfully',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: error instanceof Error ? error.message : 'Failed to update user',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleDeleteUser = async (userId: number) => {\n    if (!confirm('Are you sure you want to delete this user?')) return;\n\n    try {\n      await api.deleteUser(userId);\n      loadData();\n      toast({\n        title: 'Success',\n        description: 'User deleted successfully',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to delete user',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  if (loading) {\n    return (\n      <Layout>\n        <div className=\"min-h-[calc(100vh-8rem)] flex items-center justify-center\">\n          <div className=\"text-lg\">Loading...</div>\n        </div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <div className=\"bg-gray-50 dark:bg-gray-950 min-h-[calc(100vh-8rem)]\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          <div className=\"mb-6 flex justify-between items-center\">\n            <Button variant=\"ghost\" onClick={() => setLocation('/dashboard')}>\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              Back to Files\n            </Button>\n            <h1 className=\"text-xl font-semibold text-gray-900 dark:text-gray-100\">Admin Panel</h1>\n          </div>\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <Card className=\"dark:bg-gray-900 dark:border-gray-800\">\n            <CardHeader>\n              <div className=\"flex justify-between items-center\">\n                <div>\n                  <CardTitle className=\"dark:text-gray-100\">Users</CardTitle>\n                  <CardDescription className=\"dark:text-gray-400\">Manage user accounts and permissions</CardDescription>\n                </div>\n                <Button onClick={() => setCreateUserOpen(true)}>\n                  <UserPlus className=\"w-4 h-4 mr-2\" />\n                  Add User\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {users.map((user) => (\n                  <div key={user.id} className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700\">\n                    <div>\n                      <p className=\"font-medium text-gray-900 dark:text-gray-100\">{user.username}</p>\n                      <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                        {user.is_admin ? 'Admin' : user.roles.map(r => r.name).join(', ') || 'No roles'}\n                      </p>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleEditUser(user)}\n                        className=\"text-blue-600 hover:text-blue-700\"\n                      >\n                        <Edit className=\"w-4 h-4\" />\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => handleDeleteUser(user.id)}\n                        className=\"text-red-600 hover:text-red-700\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"dark:bg-gray-900 dark:border-gray-800\">\n            <CardHeader>\n              <CardTitle className=\"dark:text-gray-100\">Roles & Permissions</CardTitle>\n              <CardDescription className=\"dark:text-gray-400\">Default roles and their permissions</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {roles.map((role) => (\n                  <div key={role.id} className=\"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700\">\n                    <div className=\"flex items-center mb-2\">\n                      <Shield className=\"w-4 h-4 text-blue-600 dark:text-blue-400 mr-2\" />\n                      <p className=\"font-medium text-gray-900 dark:text-gray-100\">{role.name}</p>\n                    </div>\n                    <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">{role.description}</p>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {role.can_read && <span className=\"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded\">Read</span>}\n                      {role.can_write && <span className=\"text-xs px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded\">Write</span>}\n                      {role.can_copy && <span className=\"text-xs px-2 py-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded\">Copy</span>}\n                      {role.can_delete && <span className=\"text-xs px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded\">Delete</span>}\n                      {role.can_share && <span className=\"text-xs px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded\">Share</span>}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      <Dialog open={createUserOpen} onOpenChange={setCreateUserOpen}>\n        <DialogContent className=\"dark:bg-gray-900 dark:border-gray-800\">\n          <DialogHeader>\n            <DialogTitle className=\"dark:text-gray-100\">Create New User</DialogTitle>\n            <DialogDescription className=\"dark:text-gray-400\">Add a new user to the system</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium dark:text-gray-200\">Username</label>\n              <Input\n                value={newUser.username}\n                onChange={(e) => setNewUser({ ...newUser, username: e.target.value })}\n                placeholder=\"Enter username\"\n                className=\"dark:bg-gray-800 dark:border-gray-700\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium dark:text-gray-200\">Password</label>\n              <Input\n                type=\"password\"\n                value={newUser.password}\n                onChange={(e) => setNewUser({ ...newUser, password: e.target.value })}\n                placeholder=\"Enter password\"\n                className=\"dark:bg-gray-800 dark:border-gray-700\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium dark:text-gray-200\">Email (optional)</label>\n              <Input\n                type=\"email\"\n                value={newUser.email}\n                onChange={(e) => setNewUser({ ...newUser, email: e.target.value })}\n                placeholder=\"Enter email\"\n                className=\"dark:bg-gray-800 dark:border-gray-700\"\n              />\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"checkbox\"\n                id=\"is-admin\"\n                checked={newUser.isAdmin}\n                onChange={(e) => setNewUser({ ...newUser, isAdmin: e.target.checked })}\n                className=\"dark:bg-gray-800\"\n              />\n              <label htmlFor=\"is-admin\" className=\"text-sm font-medium dark:text-gray-200\">Administrator</label>\n            </div>\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium dark:text-gray-200\">Roles</label>\n              <div className=\"space-y-2 max-h-40 overflow-y-auto border dark:border-gray-700 rounded p-2 dark:bg-gray-800\">\n                {roles.map((role) => (\n                  <div key={role.id} className=\"flex items-center space-x-2\">\n                    <input\n                      type=\"checkbox\"\n                      id={`role-${role.id}`}\n                      checked={newUser.roleIds.includes(role.id)}\n                      onChange={(e) => {\n                        const roleIds = e.target.checked\n                          ? [...newUser.roleIds, role.id]\n                          : newUser.roleIds.filter(id => id !== role.id);\n                        setNewUser({ ...newUser, roleIds });\n                      }}\n                      className=\"dark:bg-gray-800\"\n                    />\n                    <label htmlFor={`role-${role.id}`} className=\"text-sm dark:text-gray-200\">{role.name}</label>\n                  </div>\n                ))}\n              </div>\n            </div>\n            <div className=\"flex justify-end space-x-2\">\n              <Button variant=\"outline\" onClick={() => setCreateUserOpen(false)}>Cancel</Button>\n              <Button onClick={handleCreateUser}>Create User</Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={editUserOpen} onOpenChange={setEditUserOpen}>\n        <DialogContent className=\"dark:bg-gray-900 dark:border-gray-800\">\n          <DialogHeader>\n            <DialogTitle className=\"dark:text-gray-100\">Edit User</DialogTitle>\n            <DialogDescription className=\"dark:text-gray-400\">Update user roles and permissions</DialogDescription>\n          </DialogHeader>\n          {editUser && (\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium dark:text-gray-200\">Email (optional)</label>\n                <Input\n                  type=\"email\"\n                  value={editUser.email}\n                  onChange={(e) => setEditUser({ ...editUser, email: e.target.value })}\n                  placeholder=\"Enter email\"\n                  className=\"dark:bg-gray-800 dark:border-gray-700\"\n                />\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <input\n                  type=\"checkbox\"\n                  id=\"edit-is-admin\"\n                  checked={editUser.isAdmin}\n                  onChange={(e) => setEditUser({ ...editUser, isAdmin: e.target.checked })}\n                  className=\"dark:bg-gray-800\"\n                />\n                <label htmlFor=\"edit-is-admin\" className=\"text-sm font-medium dark:text-gray-200\">Administrator</label>\n              </div>\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium dark:text-gray-200\">Roles</label>\n                <div className=\"space-y-2 max-h-40 overflow-y-auto border dark:border-gray-700 rounded p-2 dark:bg-gray-800\">\n                  {roles.map((role) => (\n                    <div key={role.id} className=\"flex items-center space-x-2\">\n                      <input\n                        type=\"checkbox\"\n                        id={`edit-role-${role.id}`}\n                        checked={editUser.roleIds.includes(role.id)}\n                        onChange={(e) => {\n                          const roleIds = e.target.checked\n                            ? [...editUser.roleIds, role.id]\n                            : editUser.roleIds.filter(id => id !== role.id);\n                          setEditUser({ ...editUser, roleIds });\n                        }}\n                        className=\"dark:bg-gray-800\"\n                      />\n                      <label htmlFor={`edit-role-${role.id}`} className=\"text-sm dark:text-gray-200\">{role.name}</label>\n                    </div>\n                  ))}\n                </div>\n              </div>\n              <div className=\"flex justify-end space-x-2\">\n                <Button variant=\"outline\" onClick={() => setEditUserOpen(false)}>Cancel</Button>\n                <Button onClick={handleUpdateUser}>Update User</Button>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n      </div>\n    </Layout>\n  );\n}\n\n","size_bytes":15234},"client/src/components/Layout.tsx":{"content":"import { Header } from './Header';\nimport { Footer } from './Footer';\n\ninterface LayoutProps {\n  children: React.ReactNode;\n  showHeader?: boolean;\n  showFooter?: boolean;\n}\n\nexport function Layout({ children, showHeader = true, showFooter = true }: LayoutProps) {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-white dark:bg-gray-950\">\n      {showHeader && <Header />}\n      <main className=\"flex-1\">\n        {children}\n      </main>\n      {showFooter && <Footer />}\n    </div>\n  );\n}\n","size_bytes":500},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    host: \"0.0.0.0\",\n    port: 5173,\n    strictPort: false,\n    hmr: {\n      clientPort: 443,\n      protocol: \"wss\",\n    },\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n    allowedHosts: true,\n  },\n});\n","size_bytes":1228},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"design_guidelines.md":{"content":"# EnlitEDU SFTP - Design Guidelines\n\n## Design Approach\n\n**Selected Approach:** Design System - Material Design 3 principles adapted for file management\n**Justification:** This is a utility-focused application where efficiency, clarity, and reliability are paramount. The interface prioritizes quick file operations, clear status indicators, and intuitive navigation over visual flourish.\n\n**Core Design Principles:**\n1. **Clarity First:** Every action and status must be immediately understandable\n2. **Efficiency:** Minimize clicks and cognitive load for frequent operations\n3. **Trust:** Professional appearance that instills confidence in file handling\n4. **Consistency:** Predictable patterns throughout the application\n\n---\n\n## Typography\n\n### Font System\n- **Primary Font:** Inter (via Google Fonts CDN)\n- **Monospace Font:** \"SF Mono\", Menlo, Consolas (for file names, sizes, metadata)\n\n### Type Scale\n- **Hero Heading (Auth screens):** 3xl (30px), font-bold\n- **Page Title:** 2xl (24px), font-semibold\n- **Section Headers:** xl (20px), font-semibold\n- **Card Titles:** base (16px), font-medium\n- **Body Text:** sm (14px), font-normal\n- **Metadata/Labels:** xs (12px), font-normal\n- **File Details:** xs (12px), font-mono for paths and sizes\n\n---\n\n## Layout System\n\n### Spacing Primitives\nUse Tailwind units: **2, 4, 6, 8, 12, 16, 20, 24**\n- Component padding: `p-4`, `p-6`, `p-8`\n- Section spacing: `space-y-6`, `space-y-8`\n- Grid gaps: `gap-4`, `gap-6`\n- Tight spacing (badges, pills): `px-2 py-1`\n\n### Grid Structure\n- **Container Max Width:** `max-w-7xl mx-auto`\n- **Content Padding:** `px-4 sm:px-6 lg:px-8`\n- **File Grid:** \n  - Mobile: 2 columns (`grid-cols-2`)\n  - Tablet: 3-4 columns (`sm:grid-cols-3 md:grid-cols-4`)\n  - Desktop: 5-6 columns (`lg:grid-cols-5 xl:grid-cols-6`)\n- **List View:** Single column with full-width rows\n\n### Page Structure\n1. **Header Bar** (sticky top): Logo, navigation, user menu, actions\n2. **Upload Zone** (prominent): Drag-drop area with clear visual hierarchy\n3. **Toolbar** (sticky): Search, filters, view toggles, bulk actions\n4. **Content Area**: File grid/list with infinite scroll or pagination\n5. **Dialogs/Modals**: Centered overlays for operations (copy, delete, share)\n\n---\n\n## Component Library\n\n### Navigation & Header\n**Top Navigation Bar:**\n- Height: `h-16` (64px)\n- Background: Card background with subtle border-bottom\n- Logo: Left-aligned, `h-8` (32px height)\n- User Menu: Right-aligned with avatar, dropdown\n- Action Buttons: Primary actions (New Folder, Upload) in header\n\n**Sidebar (Optional for folder navigation):**\n- Width: `w-64` (256px) on desktop, collapsible on mobile\n- Tree structure for folder hierarchy\n- Quick access sections (Recent, Shared, Trash)\n\n### Upload Zone\n**Drag-and-Drop Area:**\n- Large target: `min-h-48` (192px) when empty\n- Dashed border: `border-2 border-dashed`\n- Centered content with icon and instructions\n- Active state: Highlight with primary color overlay\n- Upload progress: Linear progress bars with file names\n\n### File Display\n\n**Grid View Cards:**\n- Aspect ratio: Square or 4:3 for file previews\n- Padding: `p-4`\n- Border radius: `rounded-lg`\n- Shadow: `shadow-sm` on hover `shadow-md`\n- File icon: Large centered icon (48px) with type color coding\n- File name: Truncated with ellipsis, tooltip on hover\n- Metadata: Size and date below name, `text-xs text-muted-foreground`\n- Actions: Kebab menu (three dots) top-right corner\n\n**List View Rows:**\n- Height: `h-16` (64px)\n- Hover background: Subtle elevation\n- Structure: Icon | Name | Size | Modified | Actions\n- Checkbox: Left-most for bulk selection\n- Name column: Flex-1 with truncation\n- Metadata columns: Fixed width\n\n### File Type Icons\nUse Lucide React icons with color coding:\n- Documents: `FileText` - Blue\n- Images: `Image` - Green\n- Videos: `Video` - Purple\n- Audio: `Music` - Orange\n- Archives: `Archive` - Gray\n- Folders: `Folder` - Yellow\n\n### Buttons & Actions\n\n**Primary Actions:**\n- Size: `h-10 px-4` (40px height)\n- Prominent positioning in header/toolbar\n- Icons with text labels on desktop, icon-only on mobile\n\n**Secondary Actions:**\n- Icon buttons: `h-8 w-8` (32px square)\n- Outline variant\n- Tooltips on hover\n\n**Contextual Actions:**\n- Dropdown menus from kebab icon\n- List items with icons and clear labels\n- Destructive actions (delete) separated with divider\n\n### Dialogs & Modals\n\n**Structure:**\n- Max width: `max-w-md` for simple dialogs, `max-w-2xl` for complex\n- Padding: `p-6`\n- Header: Title with close button\n- Content: Form fields or information\n- Footer: Cancel and confirm buttons (right-aligned)\n\n**Types:**\n- **Delete Confirmation:** Warning icon, clear consequences, two-button choice\n- **Copy/Move:** Input for destination, folder tree picker\n- **Share Link:** URL display with copy button, expiration settings\n- **Folder Creation:** Simple name input with validation\n\n### Forms & Inputs\n\n**Text Inputs:**\n- Height: `h-10` (40px)\n- Padding: `px-3`\n- Border radius: `rounded-md`\n- Focus ring: Primary color\n\n**Search Bar:**\n- Icon: Magnifying glass left-aligned\n- Placeholder: \"Search files and folders...\"\n- Clear button when text present\n- Width: `max-w-md` in toolbar\n\n**Dropdowns:**\n- Trigger: Button with chevron icon\n- Menu: Card-styled with shadow-lg\n- Options: Hover highlighting, keyboard navigation\n\n### Status & Feedback\n\n**Upload Progress:**\n- Fixed bottom-right toast container\n- Individual file cards with progress bars\n- Success/error states with icons\n- Auto-dismiss on completion (3s delay)\n\n**Toast Notifications:**\n- Position: Top-right corner\n- Types: Success (green), Error (red), Info (blue)\n- Duration: 3-5 seconds auto-dismiss\n- Icon + message + optional action button\n\n**Empty States:**\n- Large icon (96px)\n- Heading and description\n- Call-to-action button\n- Different states: No files, no search results, error state\n\n**Loading States:**\n- Skeleton screens for file grids\n- Spinner for actions in progress\n- Disabled states for buttons during operations\n\n### Authentication Screens\n\n**Login/Register Pages:**\n- Centered card on plain background\n- Logo at top\n- Form fields with clear labels\n- Primary CTA button\n- Social login options (Google, GitHub)\n- Links for password reset, sign up toggle\n\n**Layout:**\n- Two-column on desktop: Form (left 40%) | Brand visual (right 60%)\n- Single column on mobile: Form only\n- Form card: `max-w-md` centered, `p-8`\n\n---\n\n## Animations\n\n**Use Sparingly - Functional Only:**\n- **Hover States:** Subtle elevation change (shadow increase)\n- **Clicks:** Quick scale down (0.98) on active state\n- **Transitions:** 150ms ease for color/shadow changes\n- **Upload Progress:** Smooth bar animation\n- **Skeleton Loading:** Subtle pulse effect\n- **No decorative animations** - this is a productivity tool\n\n---\n\n## Responsive Behavior\n\n**Breakpoints:**\n- Mobile: Base (< 640px)\n- Tablet: sm (640px+)\n- Desktop: lg (1024px+)\n- Wide: xl (1280px+)\n\n**Mobile Adaptations:**\n- Collapse sidebar to hamburger menu\n- Stack toolbar items vertically\n- Reduce grid columns to 2\n- Icon-only buttons where appropriate\n- Bottom navigation for primary actions\n\n---\n\n## Images\n\n**Logo Usage:**\n- Header logo: Full color EnlitEDU logo, height 32px\n- Auth pages: Larger logo (64px) at top of form\n- Favicon: Icon-only version\n\n**Illustrations:**\n- Empty state illustrations: Simple, flat-style illustrations for \"no files\" states\n- Error states: Friendly illustrations for 404, server errors\n- Style: Match brand colors (blue/gold from logo)\n\n**No Hero Images:** This is a utility application - focus on functionality, not marketing visuals.\n\n---\n\n## Accessibility\n\n- All interactive elements: Focus rings with primary color\n- Icon buttons: aria-labels and tooltips\n- Form inputs: Proper labels and error messages\n- Keyboard navigation: Full support for all actions\n- Color contrast: WCAG AA minimum for all text\n- Screen reader: Semantic HTML with appropriate ARIA attributes","size_bytes":7906},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/EmptyState.tsx":{"content":"import { FileX, Search, FolderOpen } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\ninterface EmptyStateProps {\n  type: 'no-files' | 'no-results' | 'error';\n  searchQuery?: string;\n  onClearSearch?: () => void;\n  onUpload?: () => void;\n}\n\nexport function EmptyState({ type, searchQuery, onClearSearch, onUpload }: EmptyStateProps) {\n  if (type === 'no-results') {\n    return (\n      <div className=\"flex flex-col items-center justify-center py-16 px-4\" data-testid=\"empty-state-no-results\">\n        <div className=\"flex items-center justify-center w-24 h-24 rounded-full bg-muted/50 mb-6\">\n          <Search className=\"h-12 w-12 text-muted-foreground\" />\n        </div>\n        <h3 className=\"text-xl font-semibold mb-2\">No files found</h3>\n        <p className=\"text-sm text-muted-foreground text-center max-w-md mb-6\">\n          We couldn't find any files matching \"<span className=\"font-medium\">{searchQuery}</span>\"\n        </p>\n        {onClearSearch && (\n          <Button variant=\"outline\" onClick={onClearSearch} data-testid=\"button-clear-search\">\n            Clear search\n          </Button>\n        )}\n      </div>\n    );\n  }\n\n  if (type === 'error') {\n    return (\n      <div className=\"flex flex-col items-center justify-center py-16 px-4\" data-testid=\"empty-state-error\">\n        <div className=\"flex items-center justify-center w-24 h-24 rounded-full bg-destructive/10 mb-6\">\n          <FileX className=\"h-12 w-12 text-destructive\" />\n        </div>\n        <h3 className=\"text-xl font-semibold mb-2\">Failed to load files</h3>\n        <p className=\"text-sm text-muted-foreground text-center max-w-md\">\n          There was an error loading your files. Please try refreshing the page.\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col items-center justify-center py-16 px-4\" data-testid=\"empty-state-no-files\">\n      <div className=\"flex items-center justify-center w-24 h-24 rounded-full bg-primary/10 mb-6\">\n        <FolderOpen className=\"h-12 w-12 text-primary\" />\n      </div>\n      <h3 className=\"text-xl font-semibold mb-2\">No files yet</h3>\n      <p className=\"text-sm text-muted-foreground text-center max-w-md mb-6\">\n        Get started by uploading your first file. You can drag and drop files or click the upload zone above.\n      </p>\n      {onUpload && (\n        <Button onClick={onUpload} data-testid=\"button-upload-first\">\n          Upload your first file\n        </Button>\n      )}\n    </div>\n  );\n}\n","size_bytes":2485},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"backend/models/user.py":{"content":"from sqlalchemy import Column, Integer, String, Boolean, DateTime, ForeignKey, Table\nfrom sqlalchemy.orm import relationship\nfrom datetime import datetime\nfrom backend.database.db import Base\n\nuser_roles = Table(\n    'user_roles',\n    Base.metadata,\n    Column('user_id', Integer, ForeignKey('users.id'), primary_key=True),\n    Column('role_id', Integer, ForeignKey('roles.id'), primary_key=True)\n)\n\nclass User(Base):\n    __tablename__ = \"users\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    username = Column(String, unique=True, index=True, nullable=False)\n    email = Column(String, unique=True, index=True)\n    hashed_password = Column(String, nullable=False)\n    is_active = Column(Boolean, default=True)\n    is_admin = Column(Boolean, default=False)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    created_by = Column(Integer, ForeignKey('users.id'), nullable=True)\n    \n    roles = relationship(\"Role\", secondary=user_roles, back_populates=\"users\")\n    files = relationship(\"File\", back_populates=\"owner\")\n\nclass Role(Base):\n    __tablename__ = \"roles\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    name = Column(String, unique=True, nullable=False)\n    description = Column(String)\n    can_read = Column(Boolean, default=True)\n    can_write = Column(Boolean, default=False)\n    can_copy = Column(Boolean, default=False)\n    can_delete = Column(Boolean, default=False)\n    can_share = Column(Boolean, default=False)\n    \n    users = relationship(\"User\", secondary=user_roles, back_populates=\"roles\")\n","size_bytes":1558},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"backend/main.py":{"content":"\n\nfrom fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom fastapi.staticfiles import StaticFiles\nfrom fastapi.responses import FileResponse\nfrom fastapi.exceptions import RequestValidationError\nfrom starlette.exceptions import HTTPException as StarletteHTTPException\nimport os\n\nfrom backend.routes import auth, users, roles, files\nfrom backend.database.db import init_db, SessionLocal\nfrom backend.database.seeds import ensure_seed_data\n\napp = FastAPI(title=\"EnlitEDU SFTP API\", version=\"1.0.0\")\n\nallowed_origins = os.getenv(\"ALLOWED_ORIGINS\", \"*\").split(\",\")\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=allowed_origins,\n    allow_credentials=False,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\n# Register all API routers FIRST - before any other routes\napp.include_router(auth.router)\napp.include_router(users.router)\napp.include_router(roles.router)\napp.include_router(files.router)\n\n@app.on_event(\"startup\")\nasync def startup_event():\n    # Create database tables\n    init_db()\n    print(\" Database tables initialized\")\n    \n    # Seed initial data (roles and admin user)\n    db = SessionLocal()\n    try:\n        ensure_seed_data(db)\n    finally:\n        db.close()\n\n@app.get(\"/api/health\")\nasync def health_check():\n    return {\"status\": \"healthy\", \"service\": \"EnlitEDU SFTP\"}\n\n# Static file serving - mount assets directory\nif os.path.exists(\"dist/public\"):\n    app.mount(\"/assets\", StaticFiles(directory=\"dist/public/assets\"), name=\"assets\")\n\n# Exception handlers for serving SPA on 404s (but not for API routes)\n@app.exception_handler(StarletteHTTPException)\nasync def custom_http_exception_handler(request, exc):\n    from fastapi.responses import JSONResponse\n    \n    # Always return JSON for API routes\n    if request.url.path.startswith(\"/api\"):\n        return JSONResponse(\n            status_code=exc.status_code,\n            content={\"detail\": exc.detail}\n        )\n    \n    # For non-API routes with 404, serve the SPA\n    if exc.status_code == 404 and os.path.exists(\"dist/public/index.html\"):\n        return FileResponse(\"dist/public/index.html\")\n    \n    # Otherwise, return JSON error\n    return JSONResponse(\n        status_code=exc.status_code,\n        content={\"detail\": exc.detail}\n    )\n\n@app.exception_handler(RequestValidationError)\nasync def validation_exception_handler(request, exc):\n    # Always return JSON for validation errors\n    from fastapi.responses import JSONResponse\n    return JSONResponse(\n        status_code=422,\n        content={\"detail\": exc.errors()}\n    )\n\n# Serve index.html for the root path\n@app.get(\"/\")\nasync def serve_root():\n    if os.path.exists(\"dist/public/index.html\"):\n        return FileResponse(\"dist/public/index.html\")\n    return {\"message\": \"Frontend not built\"}\n","size_bytes":2782},"client/src/pages/home.tsx":{"content":"import { useState, useMemo, useEffect } from 'react';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { Grid3x3, List, Search, RefreshCw, Trash2, FolderPlus } from 'lucide-react';\nimport { FileUploadZone } from '@/components/FileUploadZone';\nimport { FileCard } from '@/components/FileCard';\nimport { DeleteConfirmDialog } from '@/components/DeleteConfirmDialog';\nimport { CopyFileDialog } from '@/components/CopyFileDialog';\nimport { ShareLinkDialog } from '@/components/ShareLinkDialog';\nimport { EmptyState } from '@/components/EmptyState';\nimport { UploadProgress, type UploadItem } from '@/components/UploadProgress';\nimport { UserMenu } from '@/components/UserMenu';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { useToast } from '@/hooks/use-toast';\nimport { useAuth } from '@/hooks/useAuth';\nimport { isUnauthorizedError } from '@/lib/authUtils';\nimport { queryClient, apiRequest } from '@/lib/queryClient';\nimport type { S3File, PresignedUrl, ShareLinkResponse } from '@shared/schema';\nimport { cn } from '@/lib/utils';\nimport logoUrl from '@assets/image_1761768443489.png';\n\nexport default function Home() {\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid');\n  const [searchQuery, setSearchQuery] = useState('');\n  const [deleteFile, setDeleteFile] = useState<S3File | null>(null);\n  const [copyFile, setCopyFile] = useState<S3File | null>(null);\n  const [shareFile, setShareFile] = useState<S3File | null>(null);\n  const [selectedFiles, setSelectedFiles] = useState<Set<string>>(new Set());\n  const [uploads, setUploads] = useState<UploadItem[]>([]);\n  const { toast } = useToast();\n  const { user } = useAuth();\n\n  const { data: files = [], isLoading, refetch } = useQuery<S3File[]>({\n    queryKey: ['/api/files'],\n    retry: (failureCount, error) => {\n      if (isUnauthorizedError(error as Error)) {\n        return false;\n      }\n      return failureCount < 3;\n    },\n  });\n\n  useEffect(() => {\n    const handleUnauthorized = (error: Error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Session expired\",\n          description: \"Please log in again to continue.\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 1500);\n      }\n    };\n\n    if (files && 'error' in files) {\n      handleUnauthorized(files.error as Error);\n    }\n  }, [files, toast]);\n\n  const filteredFiles = useMemo(() => {\n    if (!searchQuery.trim()) return files;\n    const query = searchQuery.toLowerCase();\n    return files.filter((file) => file.name.toLowerCase().includes(query));\n  }, [files, searchQuery]);\n\n  const deleteMutation = useMutation({\n    mutationFn: async (key: string) => {\n      return apiRequest('DELETE', '/api/files', { key });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/files'] });\n      toast({\n        title: 'File deleted',\n        description: 'The file has been successfully deleted.',\n      });\n      setDeleteFile(null);\n      setSelectedFiles(new Set());\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error as Error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: 'Delete failed',\n        description: 'Failed to delete the file. Please try again.',\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const bulkDeleteMutation = useMutation({\n    mutationFn: async (keys: string[]) => {\n      return apiRequest('POST', '/api/files/bulk-delete', { keys });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/files'] });\n      toast({\n        title: 'Files deleted',\n        description: `${selectedFiles.size} file(s) have been deleted.`,\n      });\n      setSelectedFiles(new Set());\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error as Error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: 'Bulk delete failed',\n        description: 'Failed to delete files. Please try again.',\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const copyMutation = useMutation({\n    mutationFn: async ({ sourceKey, destinationName }: { sourceKey: string; destinationName: string }) => {\n      const destinationKey = destinationName;\n      return apiRequest('POST', '/api/files/copy', { sourceKey, destinationKey, destinationName });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/files'] });\n      toast({\n        title: 'File copied',\n        description: 'The file has been successfully copied.',\n      });\n      setCopyFile(null);\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error as Error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: 'Copy failed',\n        description: 'Failed to copy the file. Please try again.',\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const handleFilesSelected = async (files: File[]) => {\n    for (const file of files) {\n      const uploadId = `${Date.now()}-${file.name}`;\n      \n      setUploads((prev) => [\n        ...prev,\n        {\n          id: uploadId,\n          name: file.name,\n          progress: 0,\n          status: 'uploading',\n        },\n      ]);\n\n      try {\n        const fileType = file.type || 'application/octet-stream';\n        \n        console.log('Requesting presigned URL for:', {\n          fileName: file.name,\n          fileType: fileType,\n          fileSize: file.size,\n        });\n\n        const presignedData = await apiRequest<PresignedUrl>('POST', '/api/upload', {\n          fileName: file.name,\n          fileType: fileType,\n          fileSize: file.size,\n        });\n\n        console.log('Received presigned data:', presignedData);\n\n        if (!presignedData || !presignedData.url || !presignedData.fields) {\n          throw new Error('Failed to get upload URL from server');\n        }\n\n        const formData = new FormData();\n        Object.entries(presignedData.fields).forEach(([key, value]) => {\n          formData.append(key, value);\n        });\n        formData.append('file', file);\n\n        await new Promise<void>((resolve, reject) => {\n          const xhr = new XMLHttpRequest();\n          \n          xhr.upload.addEventListener('progress', (e) => {\n            if (e.lengthComputable) {\n              const progress = Math.round((e.loaded / e.total) * 100);\n              setUploads((prev) =>\n                prev.map((u) =>\n                  u.id === uploadId ? { ...u, progress } : u\n                )\n              );\n            }\n          });\n\n          xhr.addEventListener('load', () => {\n            if (xhr.status >= 200 && xhr.status < 300) {\n              setUploads((prev) =>\n                prev.map((u) =>\n                  u.id === uploadId ? { ...u, status: 'success', progress: 100 } : u\n                )\n              );\n              resolve();\n            } else {\n              reject(new Error(`Upload failed with status ${xhr.status}`));\n            }\n          });\n\n          xhr.addEventListener('error', () => {\n            reject(new Error('Network error during upload'));\n          });\n\n          xhr.addEventListener('abort', () => {\n            reject(new Error('Upload was aborted'));\n          });\n\n          xhr.open('POST', presignedData.url);\n          xhr.send(formData);\n        });\n\n        await queryClient.invalidateQueries({ queryKey: ['/api/files'] });\n\n        setTimeout(() => {\n          setUploads((prev) => prev.filter((u) => u.id !== uploadId));\n        }, 3000);\n      } catch (error) {\n        console.error('Upload error:', error);\n        setUploads((prev) =>\n          prev.map((u) =>\n            u.id === uploadId\n              ? {\n                  ...u,\n                  status: 'error',\n                  error: error instanceof Error ? error.message : 'Upload failed',\n                }\n              : u\n          )\n        );\n\n        setTimeout(() => {\n          setUploads((prev) => prev.filter((u) => u.id !== uploadId));\n        }, 5000);\n      }\n    }\n  };\n\n  const handleDownload = async (file: S3File) => {\n    try {\n      const response = await apiRequest<{ url: string }>('POST', '/api/files/download', { key: file.key });\n      window.open(response.url, '_blank');\n    } catch (error) {\n      toast({\n        title: 'Download failed',\n        description: 'Failed to generate download link. Please try again.',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleCopy = (file: S3File) => {\n    setCopyFile(file);\n  };\n\n  const handleCopyConfirm = (newName: string) => {\n    if (copyFile) {\n      copyMutation.mutate({\n        sourceKey: copyFile.key,\n        destinationName: newName,\n      });\n    }\n  };\n\n  const handleShare = (file: S3File) => {\n    setShareFile(file);\n  };\n\n  const handleGenerateShareLink = async (expiresInHours: number, maxDownloads?: number): Promise<ShareLinkResponse> => {\n    if (!shareFile?.id) throw new Error('No file selected');\n    \n    const response = await apiRequest<ShareLinkResponse>('POST', '/api/files/share', {\n      fileId: shareFile.id,\n      expiresInHours,\n      maxDownloads,\n    });\n    \n    return response;\n  };\n\n  const handleDelete = (file: S3File) => {\n    setDeleteFile(file);\n  };\n\n  const handleDeleteConfirm = () => {\n    if (deleteFile) {\n      deleteMutation.mutate(deleteFile.key);\n    }\n  };\n\n  const handleToggleSelect = (fileId: string) => {\n    setSelectedFiles((prev) => {\n      const next = new Set(prev);\n      if (next.has(fileId)) {\n        next.delete(fileId);\n      } else {\n        next.add(fileId);\n      }\n      return next;\n    });\n  };\n\n  const handleSelectAll = () => {\n    if (selectedFiles.size === filteredFiles.length) {\n      setSelectedFiles(new Set());\n    } else {\n      setSelectedFiles(new Set(filteredFiles.map(f => f.id || f.key)));\n    }\n  };\n\n  const handleBulkDelete = () => {\n    const keys = filteredFiles\n      .filter(f => selectedFiles.has(f.id || f.key))\n      .map(f => f.key);\n    \n    if (keys.length > 0) {\n      bulkDeleteMutation.mutate(keys);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <header className=\"sticky top-0 z-40 border-b border-border bg-card\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex items-center justify-between h-16\">\n            <div className=\"flex items-center gap-3\">\n              <img src={logoUrl} alt=\"EnlitEDU\" className=\"h-8\" />\n            </div>\n            {user && <UserMenu user={user} />}\n          </div>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"space-y-8\">\n          <FileUploadZone\n            onFilesSelected={handleFilesSelected}\n            isUploading={uploads.some((u) => u.status === 'uploading')}\n          />\n\n          <div className=\"space-y-6\">\n            <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4\">\n              <div className=\"relative flex-1 max-w-md w-full\">\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search files...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"pl-9\"\n                  data-testid=\"input-search\"\n                />\n              </div>\n\n              <div className=\"flex items-center gap-2 flex-wrap\">\n                {selectedFiles.size > 0 && (\n                  <>\n                    <span className=\"text-sm text-muted-foreground\">\n                      {selectedFiles.size} selected\n                    </span>\n                    <Button\n                      variant=\"destructive\"\n                      size=\"sm\"\n                      onClick={handleBulkDelete}\n                      disabled={bulkDeleteMutation.isPending}\n                      data-testid=\"bulk-delete\"\n                    >\n                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                      Delete selected\n                    </Button>\n                  </>\n                )}\n                \n                <Button\n                  variant=\"outline\"\n                  size=\"icon\"\n                  onClick={() => refetch()}\n                  disabled={isLoading}\n                  data-testid=\"button-refresh\"\n                >\n                  <RefreshCw className={cn('h-4 w-4', isLoading && 'animate-spin')} />\n                </Button>\n                \n                <div className=\"flex items-center gap-1 border rounded-lg p-1\">\n                  <Button\n                    variant={viewMode === 'grid' ? 'secondary' : 'ghost'}\n                    size=\"icon\"\n                    className=\"h-8 w-8\"\n                    onClick={() => setViewMode('grid')}\n                    data-testid=\"button-view-grid\"\n                  >\n                    <Grid3x3 className=\"h-4 w-4\" />\n                  </Button>\n                  <Button\n                    variant={viewMode === 'list' ? 'secondary' : 'ghost'}\n                    size=\"icon\"\n                    className=\"h-8 w-8\"\n                    onClick={() => setViewMode('list')}\n                    data-testid=\"button-view-list\"\n                  >\n                    <List className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n\n            {filteredFiles.length > 0 && viewMode === 'list' && (\n              <div className=\"flex items-center gap-4 px-4 py-2 text-xs font-medium text-muted-foreground\">\n                <Checkbox\n                  checked={selectedFiles.size === filteredFiles.length && filteredFiles.length > 0}\n                  onCheckedChange={handleSelectAll}\n                  data-testid=\"select-all\"\n                />\n                <div className=\"flex-1\">Name</div>\n                <div className=\"w-20 text-right\">Size</div>\n                <div className=\"w-32 text-right\">Modified</div>\n                <div className=\"w-10\"></div>\n              </div>\n            )}\n\n            {isLoading ? (\n              <div className=\"flex items-center justify-center py-16\">\n                <RefreshCw className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n              </div>\n            ) : filteredFiles.length === 0 ? (\n              searchQuery ? (\n                <EmptyState\n                  type=\"no-results\"\n                  searchQuery={searchQuery}\n                  onClearSearch={() => setSearchQuery('')}\n                />\n              ) : (\n                <EmptyState type=\"no-files\" />\n              )\n            ) : (\n              <div\n                className={cn(\n                  viewMode === 'grid'\n                    ? 'grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4'\n                    : 'space-y-2'\n                )}\n                data-testid=\"file-list\"\n              >\n                {filteredFiles.map((file) => (\n                  <FileCard\n                    key={file.key}\n                    file={file}\n                    viewMode={viewMode}\n                    isSelected={selectedFiles.has(file.id || file.key)}\n                    onToggleSelect={handleToggleSelect}\n                    onDownload={handleDownload}\n                    onCopy={handleCopy}\n                    onShare={handleShare}\n                    onDelete={handleDelete}\n                  />\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      <DeleteConfirmDialog\n        file={deleteFile}\n        isOpen={!!deleteFile}\n        onClose={() => setDeleteFile(null)}\n        onConfirm={handleDeleteConfirm}\n        isDeleting={deleteMutation.isPending}\n      />\n\n      <CopyFileDialog\n        file={copyFile}\n        isOpen={!!copyFile}\n        onClose={() => setCopyFile(null)}\n        onConfirm={handleCopyConfirm}\n        isCopying={copyMutation.isPending}\n      />\n\n      <ShareLinkDialog\n        file={shareFile}\n        isOpen={!!shareFile}\n        onClose={() => setShareFile(null)}\n        onGenerate={handleGenerateShareLink}\n      />\n\n      <UploadProgress uploads={uploads} />\n    </div>\n  );\n}\n","size_bytes":17142},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/Header.tsx":{"content":"\nimport { Link, useLocation } from 'wouter';\nimport { useQuery } from '@tanstack/react-query';\nimport { useTheme } from 'next-themes';\nimport enlitEduLogo from '../assets/enlitedu-logo.png';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { LogOut, User as UserIcon, Settings, Moon, Sun } from 'lucide-react';\nimport { api } from '@/api/api';\n\nexport function Header() {\n  const [location, setLocation] = useLocation();\n  const { resolvedTheme, setTheme } = useTheme();\n  \n  // Don't show user info on login/landing pages\n  const isPublicPage = location === '/' || location === '/login';\n  \n  const { data: user } = useQuery({\n    queryKey: ['/api/auth/me'],\n    queryFn: () => api.getCurrentUser(),\n    retry: false,\n    enabled: !!localStorage.getItem('access_token') && !isPublicPage,\n  });\n\n  const isAuthenticated = !!user && !isPublicPage;\n  const isAdmin = user?.is_admin === true;\n\n  const handleLogout = () => {\n    api.logout();\n    setLocation('/login');\n  };\n\n  return (\n    <header className=\"border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 sticky top-0 z-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex items-center justify-between h-16\">\n          <Link href={isAuthenticated ? \"/dashboard\" : \"/\"}>\n            <a className=\"flex items-center gap-3 hover:opacity-80 transition-opacity\">\n              <img src={enlitEduLogo} alt=\"EnlitEDU\" className=\"h-10\" />\n              <div className=\"flex flex-col\">\n                <span className=\"text-xl font-bold bg-gradient-to-r from-blue-600 to-cyan-500 bg-clip-text text-transparent\">\n                  EnlitEDU SFTP\n                </span>\n                <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                  Cloud File Management\n                </span>\n              </div>\n            </a>\n          </Link>\n\n          <div className=\"flex items-center gap-4\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setTheme(resolvedTheme === 'dark' ? 'light' : 'dark')}\n              className=\"gap-2\"\n            >\n              {resolvedTheme === 'dark' ? (\n                <Sun className=\"h-4 w-4\" />\n              ) : (\n                <Moon className=\"h-4 w-4\" />\n              )}\n            </Button>\n\n            {isAuthenticated && user && (\n              <>\n                <div className=\"flex items-center gap-2\">\n                  <UserIcon className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Welcome, <span className=\"font-medium\">{user.username}</span>\n                  </span>\n                </div>\n\n                {isAdmin && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setLocation('/admin')}\n                    className=\"gap-2\"\n                  >\n                    <Settings className=\"h-4 w-4\" />\n                    Admin\n                  </Button>\n                )}\n\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleLogout}\n                  className=\"gap-2\"\n                >\n                  <LogOut className=\"h-4 w-4\" />\n                  Logout\n                </Button>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n    </header>\n  );\n}\n","size_bytes":3539},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"backend/config.py":{"content":"import os\nfrom pydantic_settings import BaseSettings\n\nclass Settings(BaseSettings):\n    DATABASE_URL: str = os.getenv(\"DATABASE_URL\", \"postgresql://user:password@localhost:5432/enlitedu\")\n    SECRET_KEY: str = os.getenv(\"SECRET_KEY\", \"your-secret-key-change-in-production\")\n    ALGORITHM: str = \"HS256\"\n    ACCESS_TOKEN_EXPIRE_MINUTES: int = 60 * 24\n    \n    # Oracle Cloud Object Storage Configuration\n    ORACLE_ACCESS_KEY: str = os.getenv(\"ORACLE_ACCESS_KEY\", \"\")\n    ORACLE_SECRET_KEY: str = os.getenv(\"ORACLE_SECRET_KEY\", \"\")\n    ORACLE_NAMESPACE: str = os.getenv(\"ORACLE_NAMESPACE\", \"\")\n    ORACLE_REGION: str = os.getenv(\"ORACLE_REGION\", \"us-phoenix-1\")\n    ORACLE_BUCKET_NAME: str = os.getenv(\"ORACLE_BUCKET_NAME\", \"\")\n    \n    class Config:\n        env_file = \".env\"\n\nsettings = Settings()\n","size_bytes":799},"client/src/components/FileUploadDialog.tsx":{"content":"import { useState, useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { api } from '../api/api';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from './ui/dialog';\nimport { Button } from './ui/button';\nimport { Progress } from './ui/progress';\nimport { Upload, File, X, CheckCircle2 } from 'lucide-react';\nimport { useToast } from '../hooks/use-toast';\n\ninterface FileUploadDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSuccess: () => void;\n  currentFolder?: string;\n}\n\ninterface UploadingFile {\n  file: File;\n  progress: number;\n  status: 'pending' | 'uploading' | 'completed' | 'error';\n  error?: string;\n}\n\nexport function FileUploadDialog({ open, onOpenChange, onSuccess, currentFolder = '/' }: FileUploadDialogProps) {\n  const { toast } = useToast();\n  const [files, setFiles] = useState<UploadingFile[]>([]);\n  const [uploading, setUploading] = useState(false);\n\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    const newFiles = acceptedFiles.map(file => ({\n      file,\n      progress: 0,\n      status: 'pending' as const,\n    }));\n    setFiles(prev => [...prev, ...newFiles]);\n  }, []);\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({ onDrop });\n\n  const removeFile = (index: number) => {\n    setFiles(files.filter((_, i) => i !== index));\n  };\n\n  const uploadFiles = async () => {\n    setUploading(true);\n\n    for (let i = 0; i < files.length; i++) {\n      const fileItem = files[i];\n      if (fileItem.status !== 'pending') continue;\n\n      try {\n        setFiles(prev => prev.map((f, idx) => \n          idx === i ? { ...f, status: 'uploading', progress: 10 } : f\n        ));\n\n        const uploadData = await api.getUploadUrl(\n          fileItem.file.name,\n          fileItem.file.type || 'application/octet-stream',\n          currentFolder\n        );\n\n        setFiles(prev => prev.map((f, idx) => \n          idx === i ? { ...f, progress: 30 } : f\n        ));\n\n        await api.uploadFile(fileItem.file, uploadData.upload_url, uploadData.upload_fields);\n\n        setFiles(prev => prev.map((f, idx) => \n          idx === i ? { ...f, progress: 70 } : f\n        ));\n\n        // Complete the upload to update file metadata\n        const completeResponse = await fetch(`/api/files/${uploadData.file_id}/complete-upload`, {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('access_token')}`,\n            'Content-Type': 'application/json',\n          },\n        });\n\n        if (!completeResponse.ok) {\n          console.error('Failed to complete upload metadata, but file was uploaded to S3');\n        }\n\n        // Update file metadata after successful upload\n        setFiles(prev => prev.map((f, idx) => \n          idx === i ? { ...f, status: 'completed', progress: 100 } : f\n        ));\n        \n        // Small delay to ensure S3 consistency\n        await new Promise(resolve => setTimeout(resolve, 500));\n      } catch (error) {\n        setFiles(prev => prev.map((f, idx) => \n          idx === i ? { \n            ...f, \n            status: 'error', \n            error: error instanceof Error ? error.message : 'Upload failed'\n          } : f\n        ));\n      }\n    }\n\n    setUploading(false);\n    const completed = files.filter(f => f.status === 'completed').length;\n    \n    if (completed > 0) {\n      toast({\n        title: 'Success',\n        description: `Uploaded ${completed} file(s) successfully`,\n      });\n      onSuccess();\n    }\n  };\n\n  const handleClose = () => {\n    setFiles([]);\n    onOpenChange(false);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-2xl\">\n        <DialogHeader>\n          <DialogTitle>Upload Files</DialogTitle>\n          <DialogDescription>\n            Drag and drop files or click to browse\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div\n            {...getRootProps()}\n            className={`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${\n              isDragActive ? 'border-blue-500 bg-blue-50' : 'border-gray-300 hover:border-gray-400'\n            }`}\n          >\n            <input {...getInputProps()} />\n            <Upload className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\n            {isDragActive ? (\n              <p className=\"text-blue-600 font-medium\">Drop files here...</p>\n            ) : (\n              <>\n                <p className=\"text-gray-600 font-medium mb-2\">\n                  Drag and drop files here, or click to select\n                </p>\n                <p className=\"text-sm text-gray-500\">\n                  Upload any files from your computer\n                </p>\n              </>\n            )}\n          </div>\n\n          {files.length > 0 && (\n            <div className=\"space-y-2 max-h-64 overflow-y-auto\">\n              {files.map((file, index) => (\n                <div key={index} className=\"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg\">\n                  {file.status === 'completed' ? (\n                    <CheckCircle2 className=\"w-5 h-5 text-green-500 flex-shrink-0\" />\n                  ) : (\n                    <File className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\n                  )}\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium text-gray-900 truncate\">\n                      {file.file.name}\n                    </p>\n                    <p className=\"text-xs text-gray-500\">\n                      {(file.file.size / 1024).toFixed(1)} KB\n                    </p>\n                    {file.status === 'uploading' && (\n                      <Progress value={file.progress} className=\"mt-1 h-1\" />\n                    )}\n                    {file.status === 'completed' && (\n                      <p className=\"text-xs text-green-600 font-medium mt-1\">Completed</p>\n                    )}\n                    {file.status === 'error' && (\n                      <p className=\"text-xs text-red-600 mt-1\">{file.error}</p>\n                    )}\n                  </div>\n                  {file.status === 'pending' && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => removeFile(index)}\n                      disabled={uploading}\n                    >\n                      <X className=\"w-4 h-4\" />\n                    </Button>\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n\n          <div className=\"flex justify-end space-x-2\">\n            <Button variant=\"outline\" onClick={handleClose} disabled={uploading}>\n              Cancel\n            </Button>\n            <Button \n              onClick={uploadFiles} \n              disabled={files.length === 0 || uploading || files.every(f => f.status !== 'pending')}\n            >\n              {uploading ? 'Uploading...' : `Upload ${files.filter(f => f.status === 'pending').length} file(s)`}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":7195},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/DeleteConfirmDialog.tsx":{"content":"import { AlertTriangle } from 'lucide-react';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\nimport type { S3File } from '@shared/schema';\n\ninterface DeleteConfirmDialogProps {\n  file: S3File | null;\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  isDeleting?: boolean;\n}\n\nexport function DeleteConfirmDialog({\n  file,\n  isOpen,\n  onClose,\n  onConfirm,\n  isDeleting = false,\n}: DeleteConfirmDialogProps) {\n  return (\n    <AlertDialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <AlertDialogContent data-testid=\"delete-dialog\">\n        <AlertDialogHeader>\n          <div className=\"flex items-center gap-3 mb-2\">\n            <div className=\"flex items-center justify-center w-10 h-10 rounded-full bg-destructive/10\">\n              <AlertTriangle className=\"h-5 w-5 text-destructive\" />\n            </div>\n            <AlertDialogTitle>Delete file?</AlertDialogTitle>\n          </div>\n          <AlertDialogDescription className=\"text-left\">\n            Are you sure you want to delete <span className=\"font-medium text-foreground\">\"{file?.name}\"</span>?\n            This action cannot be undone and the file will be permanently removed from your storage.\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel disabled={isDeleting} data-testid=\"cancel-delete\">\n            Cancel\n          </AlertDialogCancel>\n          <AlertDialogAction\n            onClick={onConfirm}\n            disabled={isDeleting}\n            className=\"bg-destructive hover:bg-destructive/90\"\n            data-testid=\"confirm-delete\"\n          >\n            {isDeleting ? 'Deleting...' : 'Delete file'}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}\n","size_bytes":1969},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/pages/landing.tsx":{"content":"import { FileUp, Shield, Zap, Users } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Layout } from '@/components/Layout';\nimport enlitEduLogo from '../assets/enlitedu-logo.png';\n\nexport default function Landing() {\n  return (\n    <Layout>\n\n      {/* Hero Section */}\n      <section className=\"py-20 px-4 sm:px-6 lg:px-8\">\n        <div className=\"max-w-7xl mx-auto text-center\">\n          <div className=\"flex justify-center mb-8\">\n            <img src={enlitEduLogo} alt=\"EnlitEDU\" className=\"h-20\" />\n          </div>\n          \n          <h1 className=\"text-4xl sm:text-5xl lg:text-6xl font-bold mb-6 bg-gradient-to-r from-blue-600 to-yellow-500 bg-clip-text text-transparent\">\n            Secure File Transfer & Storage\n          </h1>\n          \n          <p className=\"text-xl text-muted-foreground max-w-3xl mx-auto mb-8\">\n            EnlitEDU SFTP provides enterprise-grade cloud storage with seamless file management,\n            secure sharing, and real-time collaboration for educational institutions.\n          </p>\n          \n          <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n            <Button size=\"lg\" asChild data-testid=\"get-started\">\n              <a href=\"/login\" className=\"min-w-40\">\n                Get Started\n              </a>\n            </Button>\n            <Button size=\"lg\" variant=\"outline\" asChild>\n              <a href=\"#features\" className=\"min-w-40\">\n                Learn More\n              </a>\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section id=\"features\" className=\"py-20 px-4 sm:px-6 lg:px-8 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto\">\n          <h2 className=\"text-3xl font-bold text-center mb-12\">\n            Everything you need for secure file management\n          </h2>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            <div className=\"bg-card rounded-lg p-6 border border-card-border\">\n              <div className=\"flex items-center justify-center w-12 h-12 rounded-lg bg-primary/10 mb-4\">\n                <FileUp className=\"h-6 w-6 text-primary\" />\n              </div>\n              <h3 className=\"text-lg font-semibold mb-2\">Easy Upload</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                Drag and drop files or browse to upload. Support for bulk uploads and all file types.\n              </p>\n            </div>\n            \n            <div className=\"bg-card rounded-lg p-6 border border-card-border\">\n              <div className=\"flex items-center justify-center w-12 h-12 rounded-lg bg-primary/10 mb-4\">\n                <Shield className=\"h-6 w-6 text-primary\" />\n              </div>\n              <h3 className=\"text-lg font-semibold mb-2\">Secure Storage</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                Enterprise-grade security with encrypted storage and role-based access control.\n              </p>\n            </div>\n            \n            <div className=\"bg-card rounded-lg p-6 border border-card-border\">\n              <div className=\"flex items-center justify-center w-12 h-12 rounded-lg bg-primary/10 mb-4\">\n                <Zap className=\"h-6 w-6 text-primary\" />\n              </div>\n              <h3 className=\"text-lg font-semibold mb-2\">Fast Access</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                Lightning-fast file operations with real-time sync and instant search.\n              </p>\n            </div>\n            \n            <div className=\"bg-card rounded-lg p-6 border border-card-border\">\n              <div className=\"flex items-center justify-center w-12 h-12 rounded-lg bg-primary/10 mb-4\">\n                <Users className=\"h-6 w-6 text-primary\" />\n              </div>\n              <h3 className=\"text-lg font-semibold mb-2\">Easy Sharing</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                Generate secure share links with expiration dates and download limits.\n              </p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-20 px-4 sm:px-6 lg:px-8\">\n        <div className=\"max-w-4xl mx-auto text-center bg-card rounded-2xl p-12 border border-card-border\">\n          <h2 className=\"text-3xl font-bold mb-4\">Ready to get started?</h2>\n          <p className=\"text-lg text-muted-foreground mb-8\">\n            Join thousands of users who trust EnlitEDU SFTP for their file storage needs.\n          </p>\n          <Button size=\"lg\" asChild>\n            <a href=\"/login\" data-testid=\"cta-button\">\n              Start using EnlitEDU SFTP\n            </a>\n          </Button>\n        </div>\n      </section>\n\n    </Layout>\n  );\n}\n","size_bytes":4826},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/UserMenu.tsx":{"content":"import { LogOut, User as UserIcon, Shield, Settings } from 'lucide-react';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Badge } from '@/components/ui/badge';\nimport { Link } from 'wouter';\nimport type { User } from '@shared/schema';\n\ninterface UserMenuProps {\n  user: User;\n}\n\nexport function UserMenu({ user }: UserMenuProps) {\n  const initials = [user.firstName?.[0], user.lastName?.[0]]\n    .filter(Boolean)\n    .join('')\n    .toUpperCase() || user.email?.[0]?.toUpperCase() || 'U';\n\n  const displayName = [user.firstName, user.lastName]\n    .filter(Boolean)\n    .join(' ') || user.email || 'User';\n\n  const isAdmin = user.role === 'admin' || user.is_admin;\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"ghost\" className=\"relative h-10 w-10 rounded-full\" data-testid=\"user-menu\">\n          <Avatar className=\"h-10 w-10\">\n            <AvatarImage src={user.profileImageUrl || undefined} alt={displayName} className=\"object-cover\" />\n            <AvatarFallback>{initials}</AvatarFallback>\n          </Avatar>\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-64\">\n        <DropdownMenuLabel>\n          <div className=\"flex flex-col space-y-1\">\n            <div className=\"flex items-center justify-between\">\n              <p className=\"text-sm font-medium leading-none\">{displayName}</p>\n              {isAdmin && (\n                <Badge variant=\"secondary\" className=\"text-xs\">\n                  <Shield className=\"h-3 w-3 mr-1\" />\n                  Admin\n                </Badge>\n              )}\n            </div>\n            {user.email && (\n              <p className=\"text-xs leading-none text-muted-foreground\">{user.email}</p>\n            )}\n          </div>\n        </DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem disabled>\n          <UserIcon className=\"mr-2 h-4 w-4\" />\n          <span>Profile</span>\n        </DropdownMenuItem>\n        {isAdmin && (\n          <DropdownMenuItem asChild>\n            <Link href=\"/admin\">\n              <a className=\"flex items-center w-full\">\n                <Settings className=\"mr-2 h-4 w-4\" />\n                <span>Admin Dashboard</span>\n              </a>\n            </Link>\n          </DropdownMenuItem>\n        )}\n        <DropdownMenuSeparator />\n        <DropdownMenuItem asChild>\n          <a href=\"/api/logout\" data-testid=\"logout\">\n            <LogOut className=\"mr-2 h-4 w-4\" />\n            <span>Log out</span>\n          </a>\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","size_bytes":2869},"client/src/pages/login.tsx":{"content":"\nimport { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport logoUrl from '@assets/image_1761768443489.png';\nimport { useToast } from '@/hooks/use-toast';\nimport { api } from '@/api/api';\n\nexport default function Login() {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      await api.login({ username, password });\n      window.location.href = '/';\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: error instanceof Error ? error.message : 'An error occurred during login',\n        variant: 'destructive',\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleReplitLogin = () => {\n    window.location.href = '/api/login';\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-4\">\n          <div className=\"flex justify-center\">\n            <img src={logoUrl} alt=\"EnlitEDU\" className=\"h-12\" />\n          </div>\n          <CardTitle className=\"text-2xl text-center\">Sign in to EnlitEDU SFTP</CardTitle>\n          <CardDescription className=\"text-center\">\n            Enter your credentials to access your files\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"username\">Username</Label>\n              <Input\n                id=\"username\"\n                type=\"text\"\n                placeholder=\"Enter your username\"\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                required\n                disabled={isLoading}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"Enter your password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                disabled={isLoading}\n              />\n            </div>\n            <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n              {isLoading ? 'Signing in...' : 'Sign in'}\n            </Button>\n          </form>\n\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 flex items-center\">\n              <span className=\"w-full border-t\" />\n            </div>\n            <div className=\"relative flex justify-center text-xs uppercase\">\n              <span className=\"bg-background px-2 text-muted-foreground\">\n                Or continue with\n              </span>\n            </div>\n          </div>\n\n          <Button\n            variant=\"outline\"\n            className=\"w-full\"\n            onClick={handleReplitLogin}\n            disabled={isLoading}\n          >\n            <svg className=\"mr-2 h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n              <path d=\"M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z\"/>\n            </svg>\n            Sign in with Replit\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":3727},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"server/index.ts":{"content":"import { spawn } from 'child_process';\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\nconst projectRoot = path.resolve(__dirname, '..');\n\nconst execAsync = promisify(exec);\n\nasync function startBackend() {\n  console.log('Building React frontend...');\n  \n  try {\n    await execAsync('npm run build', { cwd: projectRoot });\n    console.log('Frontend built successfully!');\n  } catch (error) {\n    console.error('Frontend build failed:', error);\n    console.error('Aborting startup due to build failure.');\n    process.exit(1);\n  }\n\n  console.log('Starting Python FastAPI backend...');\n  \n  const python = spawn('uvicorn', [\n    'backend.main:app',\n    '--host', '0.0.0.0',\n    '--port', '5000',\n    '--reload'\n  ], {\n    cwd: projectRoot,\n    stdio: 'inherit',\n    env: { ...process.env }\n  });\n\n  python.on('error', (err) => {\n    console.error('Failed to start Python backend:', err);\n    process.exit(1);\n  });\n\n  python.on('close', (code) => {\n    console.log(`Python backend exited with code ${code}`);\n    process.exit(code || 0);\n  });\n\n  process.on('SIGTERM', () => {\n    python.kill('SIGTERM');\n  });\n\n  process.on('SIGINT', () => {\n    python.kill('SIGINT');\n  });\n}\n\nstartBackend().catch(console.error);\n","size_bytes":1396},"client/src/pages/LoginPage.tsx":{"content":"import { useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { api } from '../api/api';\nimport { Button } from '../components/ui/button';\nimport { Input } from '../components/ui/input';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '../components/ui/card';\nimport { Alert, AlertDescription } from '../components/ui/alert';\nimport { Lock, User } from 'lucide-react';\nimport { useToast } from '../components/ui/use-toast';\nimport { useMutation } from '@tanstack/react-query';\nimport { Layout } from '../components/Layout';\nimport enlitEduLogo from '../assets/enlitedu-logo.png';\n\nexport function LoginPage() {\n  const [, setLocation] = useLocation();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      await api.login({ username, password });\n      setLocation('/dashboard');\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Login failed');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"min-h-[calc(100vh-8rem)] flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-blue-50 p-4\">\n        <div className=\"w-full max-w-md\">\n          <div className=\"text-center mb-8\">\n            <div className=\"flex justify-center mb-4\">\n              <img\n                src={enlitEduLogo}\n                alt=\"EnlitEDU Logo\"\n                className=\"h-20\"\n              />\n            </div>\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">EnlitEDU SFTP</h1>\n            <p className=\"text-gray-600\">Secure File Transfer & Storage Platform</p>\n          </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Welcome Back</CardTitle>\n            <CardDescription>Sign in to access your files</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleLogin} className=\"space-y-4\">\n              {error && (\n                <Alert variant=\"destructive\">\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"username\" className=\"text-sm font-medium text-gray-700\">\n                  Username\n                </label>\n                <div className=\"relative\">\n                  <User className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <Input\n                    id=\"username\"\n                    type=\"text\"\n                    value={username}\n                    onChange={(e) => setUsername(e.target.value)}\n                    placeholder=\"Enter your username\"\n                    className=\"pl-10\"\n                    autoComplete=\"username\"\n                    required\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label htmlFor=\"password\" className=\"text-sm font-medium text-gray-700\">\n                  Password\n                </label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <Input\n                    id=\"password\"\n                    type=\"password\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    placeholder=\"Enter your password\"\n                    className=\"pl-10\"\n                    autoComplete=\"current-password\"\n                    required\n                  />\n                </div>\n              </div>\n\n              <Button type=\"submit\" className=\"w-full\" disabled={loading}>\n                {loading ? 'Signing in...' : 'Sign In'}\n              </Button>\n            </form>\n          </CardContent>\n        </Card>\n        </div>\n      </div>\n    </Layout>\n  );\n}","size_bytes":4139},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"backend/models/file.py":{"content":"from sqlalchemy import Column, Integer, String, DateTime, ForeignKey, BigInteger\nfrom sqlalchemy.orm import relationship\nfrom datetime import datetime\nfrom backend.database.db import Base\n\nclass File(Base):\n    __tablename__ = \"files\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    filename = Column(String, nullable=False)\n    s3_key = Column(String, unique=True, nullable=False)\n    file_size = Column(BigInteger)\n    content_type = Column(String)\n    folder_path = Column(String, default=\"/\")\n    owner_id = Column(Integer, ForeignKey('users.id'))\n    uploaded_at = Column(DateTime, default=datetime.utcnow)\n    \n    owner = relationship(\"User\", back_populates=\"files\")\n    share_links = relationship(\"ShareLink\", back_populates=\"file\", cascade=\"all, delete-orphan\")\n\nclass ShareLink(Base):\n    __tablename__ = \"share_links\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    file_id = Column(Integer, ForeignKey('files.id'))\n    share_token = Column(String, unique=True, nullable=False)\n    expires_at = Column(DateTime, nullable=False)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    created_by = Column(Integer, ForeignKey('users.id'))\n    \n    file = relationship(\"File\", back_populates=\"share_links\")\n","size_bytes":1254},"npm-wrapper.sh":{"content":"#!/bin/bash\nif [ \"$1\" = \"run\" ] && [ \"$2\" = \"dev\" ]; then\n    echo \"Building frontend...\"\n    /usr/bin/npm run build --prefix /home/runner/workspace\n    echo \"Starting Python backend...\"\n    cd /home/runner/workspace\n    exec uvicorn backend.main:app --host 0.0.0.0 --port 5000 --reload\nelse\n    exec /usr/bin/npm \"$@\"\nfi\n","size_bytes":322},"backend/auth/security.py":{"content":"from datetime import datetime, timedelta\nfrom typing import Optional\nfrom jose import JWTError, jwt\nimport bcrypt\nfrom fastapi import Depends, HTTPException, status\nfrom fastapi.security import HTTPBearer, HTTPAuthorizationCredentials\nfrom sqlalchemy.orm import Session\nfrom backend.config import settings\nfrom backend.database.db import get_db\nfrom backend.models.user import User\n\nsecurity = HTTPBearer()\n\ndef verify_password(plain_password: str, hashed_password: str) -> bool:\n    return bcrypt.checkpw(plain_password.encode('utf-8'), hashed_password.encode('utf-8'))\n\ndef get_password_hash(password: str) -> str:\n    salt = bcrypt.gensalt()\n    hashed = bcrypt.hashpw(password.encode('utf-8'), salt)\n    return hashed.decode('utf-8')\n\ndef create_access_token(data: dict, expires_delta: Optional[timedelta] = None):\n    to_encode = data.copy()\n    if expires_delta:\n        expire = datetime.utcnow() + expires_delta\n    else:\n        expire = datetime.utcnow() + timedelta(minutes=settings.ACCESS_TOKEN_EXPIRE_MINUTES)\n    to_encode.update({\"exp\": expire})\n    encoded_jwt = jwt.encode(to_encode, settings.SECRET_KEY, algorithm=settings.ALGORITHM)\n    return encoded_jwt\n\ndef decode_token(token: str):\n    try:\n        payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])\n        return payload\n    except JWTError:\n        return None\n\nasync def get_current_user(\n    credentials: HTTPAuthorizationCredentials = Depends(security),\n    db: Session = Depends(get_db)\n) -> User:\n    credentials_exception = HTTPException(\n        status_code=status.HTTP_401_UNAUTHORIZED,\n        detail=\"Could not validate credentials\",\n        headers={\"WWW-Authenticate\": \"Bearer\"},\n    )\n    \n    token = credentials.credentials\n    payload = decode_token(token)\n    \n    if payload is None:\n        raise credentials_exception\n    \n    username: str = payload.get(\"sub\")\n    if username is None:\n        raise credentials_exception\n    \n    user = db.query(User).filter(User.username == username).first()\n    if user is None:\n        raise credentials_exception\n    \n    if not user.is_active:\n        raise HTTPException(status_code=400, detail=\"Inactive user\")\n    \n    return user\n\nasync def get_current_admin_user(current_user: User = Depends(get_current_user)) -> User:\n    if not current_user.is_admin:\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"Not enough permissions\"\n        )\n    return current_user\n\ndef check_permission(user: User, permission: str) -> bool:\n    if user.is_admin:\n        return True\n    \n    for role in user.roles:\n        if permission == \"read\" and role.can_read:\n            return True\n        elif permission == \"write\" and role.can_write:\n            return True\n        elif permission == \"copy\" and role.can_copy:\n            return True\n        elif permission == \"delete\" and role.can_delete:\n            return True\n        elif permission == \"share\" and role.can_share:\n            return True\n    \n    return False\n","size_bytes":3034},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"backend/services/__init__.py":{"content":"# Services package\n","size_bytes":19},"SETUP_COMPLETE.md":{"content":"# EnlitEDU SFTP - Setup Complete! \n\n## What's Fixed\n\n### 1.  AWS Region Issue RESOLVED\n- **Problem**: AWS_REGION was set to invalid \"us-east-q\"\n- **Solution**: Updated to \"us-east-1\"\n- **Result**: All S3 operations now working perfectly!\n\n### 2.  Logo Displaying Properly\n- **Status**: EnlitEDU logo now showing correctly in the header\n- **Location**: `/enlitedu-logo.png`\n\n### 3.  All S3 Files Now Visible\n- **Feature**: The app displays ALL files in your S3 bucket\n- **Includes**: Both app-uploaded files AND existing S3 files\n- **Folder Support**: Full folder navigation with breadcrumb trails\n\n### 4.  Folder Creation Button Available\n- **Location**: Top right of dashboard, next to \"Upload Files\"\n- **Button**: \"New Folder\" with folder icon\n- **Requires**: Write permission (Admin has this by default)\n\n### 5.  User Creation with Role Assignment\n- **Location**: Admin Panel (click \"Admin\" button in top right)\n- **Features**:\n  - Create new users\n  - Assign multiple roles with checkboxes\n  - Set admin privileges\n  - Manage user permissions\n\n### 6.  File Upload Working\n- **Method**: Direct upload to S3 using presigned URLs\n- **Features**: \n  - Drag & drop support\n  - Progress tracking\n  - Automatic refresh after upload\n\n### 7.  Share Links with 12-Hour Maximum\n- **Feature**: Generate presigned S3 download links\n- **Maximum**: 12 hours (enforced automatically)\n- **Security**: Links expire automatically\n\n## How to Use\n\n### Login\n- **URL**: Your Replit app URL\n- **Default Admin**:\n  - Username: `admin`\n  - Password: `admin123`\n-  **IMPORTANT**: Change the admin password after first login!\n\n### Dashboard Features\n\n**Top Navigation Bar:**\n- EnlitEDU logo and title\n- Admin button (for administrators only)\n- Logout button\n\n**File Management:**\n- **Refresh**: Reload files from S3\n- **New Folder**: Create folders in S3\n- **Upload Files**: Upload files with drag & drop\n- **Bulk Delete**: Select multiple files and delete\n\n**File Actions (on each file card):**\n- **Download** : Download file\n- **Copy** : Copy file to another folder\n- **Delete** : Delete file\n- **Share** : Generate share link (max 12 hours)\n\n### Folder Navigation\n- Click on any folder to open it\n- Use breadcrumb trail at top to navigate back\n- Home icon returns to root folder\n\n### Admin Panel\n**Access**: Click \"Admin\" button in top right (admin users only)\n\n**Features:**\n1. **User Management**\n   - Create new users with \"Add User\" button\n   - Assign roles with checkboxes\n   - Set admin privileges\n   - Delete users\n\n2. **Roles & Permissions**\n   - View all available roles\n   - See permissions for each role\n   - Default roles: Admin, Editor, Viewer, Contributor\n\n## Current User Roles\n\n### Admin\n- Full access to everything\n- Can read, write, copy, delete, share\n- Can manage users and roles\n\n### Editor\n- Can read, write, and share files\n- Cannot delete files\n\n### Viewer\n- Can only view and download files\n- Read-only access\n\n### Contributor\n- Can read, write, and copy files\n- Cannot delete or share\n\n## Technical Details\n\n### Environment Variables (Already Configured)\n-  `DATABASE_URL` - PostgreSQL connection\n-  `SECRET_KEY` - JWT token signing\n-  `AWS_ACCESS_KEY_ID` - AWS credentials\n-  `AWS_SECRET_ACCESS_KEY` - AWS credentials  \n-  `AWS_REGION` - **us-east-1** (FIXED!)\n-  `S3_BUCKET_NAME` - Your S3 bucket\n\n### S3 Integration\n- **Presigned URLs**: All uploads/downloads go directly to S3\n- **No server bottleneck**: Files don't go through backend\n- **Secure**: Temporary URLs with expiration\n- **Hybrid Listing**: Shows all S3 bucket contents\n\n### Database\n- **PostgreSQL**: Stores user data, roles, file metadata\n- **Auto-initialized**: Database tables created automatically\n- **Seed Data**: Default admin user and roles created on startup\n\n## What's Working Now\n\n S3 file listing (all files including folders)  \n Folder creation and navigation  \n File upload with presigned URLs  \n File download  \n File copy and delete operations  \n Share links (max 12 hours)  \n User management with role assignment  \n Role-based access control  \n Beautiful UI with EnlitEDU branding  \n Breadcrumb navigation  \n Bulk file operations  \n\n## Next Steps\n\n1. **Login** to your app using admin credentials\n2. **Change admin password** for security\n3. **Create users** and assign appropriate roles\n4. **Upload files** to test the functionality\n5. **Create folders** to organize your files\n6. **Test sharing** by generating share links\n\n## Need Help?\n\n- **Files not showing?** Click the \"Refresh\" button\n- **Can't upload?** Check that you have write permission\n- **Folder button missing?** Make sure you're logged in with write permissions\n- **Share link not working?** Links expire after the time you set (max 12 hours)\n\n---\n\n**Your EnlitEDU SFTP application is ready to use!** \n","size_bytes":4862},"backend/auth/__init__.py":{"content":"# Auth package\n","size_bytes":15},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 0 0% 100%;\n\n  --foreground: 220 13% 13%;\n\n  --border: 220 13% 91%;\n\n  --card: 220 13% 98%;\n\n  --card-foreground: 220 13% 13%;\n\n  --card-border: 220 13% 94%;\n\n  --sidebar: 220 13% 96%;\n\n  --sidebar-foreground: 220 13% 13%;\n\n  --sidebar-border: 220 13% 92%;\n\n  --sidebar-primary: 221 83% 53%;\n\n  --sidebar-primary-foreground: 221 83% 98%;\n\n  --sidebar-accent: 220 13% 88%;\n\n  --sidebar-accent-foreground: 220 13% 13%;\n\n  --sidebar-ring: 221 83% 53%;\n\n  --popover: 220 13% 94%;\n\n  --popover-foreground: 220 13% 13%;\n\n  --popover-border: 220 13% 88%;\n\n  --primary: 221 83% 53%;\n\n  --primary-foreground: 221 83% 98%;\n\n  --secondary: 220 13% 90%;\n\n  --secondary-foreground: 220 13% 13%;\n\n  --muted: 220 8% 92%;\n\n  --muted-foreground: 220 8% 38%;\n\n  --accent: 45 95% 88%;\n\n  --accent-foreground: 45 95% 25%;\n\n  --destructive: 0 84% 60%;\n\n  --destructive-foreground: 0 84% 98%;\n\n  --input: 220 13% 80%;\n  --ring: 221 83% 53%;\n  --chart-1: 221 83% 45%;\n  --chart-2: 45 95% 50%;\n  --chart-3: 173 58% 39%;\n  --chart-4: 280 65% 60%;\n  --chart-5: 25 85% 55%;\n\n  --font-sans: Inter, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: \"SF Mono\", Menlo, Monaco, Consolas, monospace;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 1px 2px 0px hsl(220 13% 13% / 0.05);\n  --shadow-xs: 0px 1px 3px 0px hsl(220 13% 13% / 0.10);\n  --shadow-sm: 0px 1px 2px 0px hsl(220 13% 13% / 0.05), 0px 2px 4px -1px hsl(220 13% 13% / 0.06);\n  --shadow: 0px 1px 3px 0px hsl(220 13% 13% / 0.10), 0px 2px 6px -2px hsl(220 13% 13% / 0.08);\n  --shadow-md: 0px 4px 6px -1px hsl(220 13% 13% / 0.10), 0px 2px 4px -2px hsl(220 13% 13% / 0.06);\n  --shadow-lg: 0px 10px 15px -3px hsl(220 13% 13% / 0.10), 0px 4px 6px -4px hsl(220 13% 13% / 0.05);\n  --shadow-xl: 0px 20px 25px -5px hsl(220 13% 13% / 0.10), 0px 8px 10px -6px hsl(220 13% 13% / 0.04);\n  --shadow-2xl: 0px 25px 50px -12px hsl(220 13% 13% / 0.25);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 220 13% 9%;\n\n  --foreground: 220 13% 95%;\n\n  --border: 220 13% 18%;\n\n  --card: 220 13% 11%;\n\n  --card-foreground: 220 13% 95%;\n\n  --card-border: 220 13% 15%;\n\n  --sidebar: 220 13% 13%;\n\n  --sidebar-foreground: 220 13% 95%;\n\n  --sidebar-border: 220 13% 17%;\n\n  --sidebar-primary: 221 83% 53%;\n\n  --sidebar-primary-foreground: 221 83% 98%;\n\n  --sidebar-accent: 220 13% 18%;\n\n  --sidebar-accent-foreground: 220 13% 95%;\n\n  --sidebar-ring: 221 83% 53%;\n\n  --popover: 220 13% 15%;\n\n  --popover-foreground: 220 13% 95%;\n\n  --popover-border: 220 13% 20%;\n\n  --primary: 221 83% 53%;\n\n  --primary-foreground: 221 83% 98%;\n\n  --secondary: 220 13% 20%;\n\n  --secondary-foreground: 220 13% 95%;\n\n  --muted: 220 8% 17%;\n\n  --muted-foreground: 220 8% 70%;\n\n  --accent: 45 65% 18%;\n\n  --accent-foreground: 45 65% 88%;\n\n  --destructive: 0 84% 60%;\n\n  --destructive-foreground: 0 84% 98%;\n\n  --input: 220 13% 28%;\n  --ring: 221 83% 53%;\n  --chart-1: 221 83% 65%;\n  --chart-2: 45 95% 70%;\n  --chart-3: 173 58% 55%;\n  --chart-4: 280 65% 75%;\n  --chart-5: 25 85% 65%;\n\n  --shadow-2xs: 0px 1px 2px 0px hsl(220 13% 0% / 0.30);\n  --shadow-xs: 0px 1px 3px 0px hsl(220 13% 0% / 0.40);\n  --shadow-sm: 0px 1px 2px 0px hsl(220 13% 0% / 0.30), 0px 2px 4px -1px hsl(220 13% 0% / 0.35);\n  --shadow: 0px 1px 3px 0px hsl(220 13% 0% / 0.40), 0px 2px 6px -2px hsl(220 13% 0% / 0.45);\n  --shadow-md: 0px 4px 6px -1px hsl(220 13% 0% / 0.45), 0px 2px 4px -2px hsl(220 13% 0% / 0.40);\n  --shadow-lg: 0px 10px 15px -3px hsl(220 13% 0% / 0.50), 0px 4px 6px -4px hsl(220 13% 0% / 0.40);\n  --shadow-xl: 0px 20px 25px -5px hsl(220 13% 0% / 0.55), 0px 8px 10px -6px hsl(220 13% 0% / 0.45);\n  --shadow-2xl: 0px 25px 50px -12px hsl(220 13% 0% / 0.60);\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}","size_bytes":11343},"client/src/components/CopyFileDialog.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Copy } from 'lucide-react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport type { S3File } from '@shared/schema';\n\ninterface CopyFileDialogProps {\n  file: S3File | null;\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: (newName: string) => void;\n  isCopying?: boolean;\n}\n\nexport function CopyFileDialog({\n  file,\n  isOpen,\n  onClose,\n  onConfirm,\n  isCopying = false,\n}: CopyFileDialogProps) {\n  const [newName, setNewName] = useState('');\n\n  useEffect(() => {\n    if (file && isOpen) {\n      // Generate copy name\n      const nameParts = file.name.split('.');\n      const ext = nameParts.length > 1 ? nameParts.pop() : '';\n      const baseName = nameParts.join('.');\n      setNewName(ext ? `${baseName} (copy).${ext}` : `${baseName} (copy)`);\n    }\n  }, [file, isOpen]);\n\n  const handleConfirm = () => {\n    if (newName.trim()) {\n      onConfirm(newName.trim());\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <DialogContent data-testid=\"copy-dialog\">\n        <DialogHeader>\n          <div className=\"flex items-center gap-3 mb-2\">\n            <div className=\"flex items-center justify-center w-10 h-10 rounded-full bg-primary/10\">\n              <Copy className=\"h-5 w-5 text-primary\" />\n            </div>\n            <DialogTitle>Make a copy</DialogTitle>\n          </div>\n          <DialogDescription>\n            Create a copy of <span className=\"font-medium text-foreground\">\"{file?.name}\"</span>\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"copy-name\">New file name</Label>\n            <Input\n              id=\"copy-name\"\n              value={newName}\n              onChange={(e) => setNewName(e.target.value)}\n              placeholder=\"Enter file name\"\n              disabled={isCopying}\n              data-testid=\"input-copy-name\"\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' && newName.trim()) {\n                  handleConfirm();\n                }\n              }}\n            />\n          </div>\n        </div>\n        \n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose} disabled={isCopying} data-testid=\"cancel-copy\">\n            Cancel\n          </Button>\n          <Button\n            onClick={handleConfirm}\n            disabled={!newName.trim() || isCopying}\n            data-testid=\"confirm-copy\"\n          >\n            {isCopying ? 'Copying...' : 'Create copy'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":2903},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"backend/init_db.py":{"content":"\"\"\"\nDatabase initialization script\nCreates initial admin user and default roles\n\"\"\"\n\nfrom sqlalchemy.orm import Session\nfrom backend.database.db import SessionLocal, init_db\nfrom backend.models.user import User, Role\nfrom backend.auth.security import get_password_hash\n\ndef create_default_roles(db: Session):\n    \"\"\"Create default roles if they don't exist\"\"\"\n    roles_data = [\n        {\n            \"name\": \"Admin\",\n            \"description\": \"Full access to all features\",\n            \"can_read\": True,\n            \"can_write\": True,\n            \"can_copy\": True,\n            \"can_delete\": True,\n            \"can_share\": True\n        },\n        {\n            \"name\": \"Editor\",\n            \"description\": \"Can read, write, and share files\",\n            \"can_read\": True,\n            \"can_write\": True,\n            \"can_copy\": False,\n            \"can_delete\": False,\n            \"can_share\": True\n        },\n        {\n            \"name\": \"Viewer\",\n            \"description\": \"Can only view files\",\n            \"can_read\": True,\n            \"can_write\": False,\n            \"can_copy\": False,\n            \"can_delete\": False,\n            \"can_share\": False\n        },\n        {\n            \"name\": \"Contributor\",\n            \"description\": \"Can read, write, and copy files\",\n            \"can_read\": True,\n            \"can_write\": True,\n            \"can_copy\": True,\n            \"can_delete\": False,\n            \"can_share\": False\n        }\n    ]\n    \n    for role_data in roles_data:\n        existing_role = db.query(Role).filter(Role.name == role_data[\"name\"]).first()\n        if not existing_role:\n            role = Role(**role_data)\n            db.add(role)\n            print(f\"Created role: {role_data['name']}\")\n    \n    db.commit()\n\ndef create_admin_user(db: Session):\n    \"\"\"Create default admin user if doesn't exist\"\"\"\n    admin_username = \"admin\"\n    admin_password = \"admin123\"  # Should be changed after first login\n    \n    existing_admin = db.query(User).filter(User.username == admin_username).first()\n    if not existing_admin:\n        admin_user = User(\n            username=admin_username,\n            hashed_password=get_password_hash(admin_password),\n            email=\"admin@enlitedu.com\",\n            is_admin=True,\n            is_active=True\n        )\n        db.add(admin_user)\n        db.commit()\n        print(f\"Created admin user: {admin_username} / {admin_password}\")\n        print(\"IMPORTANT: Please change the admin password after first login!\")\n    else:\n        print(\"Admin user already exists\")\n\ndef main():\n    print(\"Initializing database...\")\n    init_db()\n    print(\"Database tables created\")\n    \n    db = SessionLocal()\n    try:\n        create_default_roles(db)\n        create_admin_user(db)\n        print(\"\\nDatabase initialization complete!\")\n        print(\"\\nDefault credentials:\")\n        print(\"Username: admin\")\n        print(\"Password: admin123\")\n        print(\"\\nPlease change the password after first login!\")\n    finally:\n        db.close()\n\nif __name__ == \"__main__\":\n    main()\n","size_bytes":3030},"backend/database/seeds.py":{"content":"\"\"\"\nDatabase seeding functions\nCreates default roles and admin user if they don't exist\n\"\"\"\n\nfrom sqlalchemy.orm import Session\nfrom backend.models.user import User, Role\nfrom backend.auth.security import get_password_hash\n\n\ndef create_default_roles(db: Session):\n    \"\"\"Create default roles if they don't exist (idempotent)\"\"\"\n    roles_data = [\n        {\n            \"name\": \"Admin\",\n            \"description\": \"Full access to all features\",\n            \"can_read\": True,\n            \"can_write\": True,\n            \"can_copy\": True,\n            \"can_delete\": True,\n            \"can_share\": True\n        },\n        {\n            \"name\": \"Editor\",\n            \"description\": \"Can read, write, and share files\",\n            \"can_read\": True,\n            \"can_write\": True,\n            \"can_copy\": False,\n            \"can_delete\": False,\n            \"can_share\": True\n        },\n        {\n            \"name\": \"Viewer\",\n            \"description\": \"Can only view files\",\n            \"can_read\": True,\n            \"can_write\": False,\n            \"can_copy\": False,\n            \"can_delete\": False,\n            \"can_share\": False\n        },\n        {\n            \"name\": \"Contributor\",\n            \"description\": \"Can read, write, and copy files\",\n            \"can_read\": True,\n            \"can_write\": True,\n            \"can_copy\": True,\n            \"can_delete\": False,\n            \"can_share\": False\n        }\n    ]\n    \n    for role_data in roles_data:\n        existing_role = db.query(Role).filter(Role.name == role_data[\"name\"]).first()\n        if not existing_role:\n            role = Role(**role_data)\n            db.add(role)\n            print(f\"Created role: {role_data['name']}\")\n    \n    db.commit()\n\n\ndef create_admin_user(db: Session):\n    \"\"\"Create default admin user if doesn't exist (idempotent)\"\"\"\n    admin_username = \"admin\"\n    admin_password = \"admin123\"\n    \n    existing_admin = db.query(User).filter(User.username == admin_username).first()\n    if not existing_admin:\n        admin_user = User(\n            username=admin_username,\n            hashed_password=get_password_hash(admin_password),\n            email=\"admin@enlitedu.com\",\n            is_admin=True,\n            is_active=True\n        )\n        \n        # Assign Admin role if it exists\n        admin_role = db.query(Role).filter(Role.name == \"Admin\").first()\n        if admin_role:\n            admin_user.roles.append(admin_role)\n        \n        db.add(admin_user)\n        db.commit()\n        print(f\" Created admin user: {admin_username}\")\n        print(\"  Default password: admin123\")\n        print(\"    IMPORTANT: Change the password after first login!\")\n    else:\n        print(\" Admin user already exists\")\n\n\ndef ensure_seed_data(db: Session):\n    \"\"\"\n    Ensure all seed data exists in the database (idempotent)\n    This function can be called on every startup safely\n    \"\"\"\n    try:\n        print(\"Seeding database...\")\n        create_default_roles(db)\n        create_admin_user(db)\n        print(\" Database seeding complete\")\n    except Exception as e:\n        print(f\" Error seeding database: {e}\")\n        db.rollback()\n        raise\n","size_bytes":3146},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"backend/services/s3_service.py":{"content":"import boto3\nfrom botocore.exceptions import ClientError\nfrom datetime import datetime, timedelta\nfrom backend.config import settings\nimport uuid\n\nclass S3Service:\n    def __init__(self):\n        # Oracle Cloud Object Storage S3-compatible endpoint\n        endpoint_url = f\"https://{settings.ORACLE_NAMESPACE}.compat.objectstorage.{settings.ORACLE_REGION}.oraclecloud.com\"\n        \n        self.s3_client = boto3.client(\n            's3',\n            aws_access_key_id=settings.ORACLE_ACCESS_KEY,\n            aws_secret_access_key=settings.ORACLE_SECRET_KEY,\n            region_name=settings.ORACLE_REGION,\n            endpoint_url=endpoint_url\n        )\n        self.bucket_name = settings.ORACLE_BUCKET_NAME\n\n    def generate_presigned_upload_url(self, s3_key: str, content_type: str, expiration: int = 3600):\n        try:\n            # Use the exact s3_key provided (no UUID prefix)\n            unique_key = s3_key\n            response = self.s3_client.generate_presigned_post(\n                Bucket=self.bucket_name,\n                Key=unique_key,\n                Fields={\"Content-Type\": content_type},\n                Conditions=[\n                    {\"Content-Type\": content_type},\n                    [\"content-length-range\", 0, 104857600]\n                ],\n                ExpiresIn=expiration\n            )\n            return response\n        except ClientError as e:\n            print(f\"Error generating presigned upload URL: {e}\")\n            return None\n\n    def generate_presigned_download_url(self, key: str, expiration: int = 3600):\n        try:\n            response = self.s3_client.generate_presigned_url(\n                'get_object',\n                Params={'Bucket': self.bucket_name, 'Key': key},\n                ExpiresIn=expiration\n            )\n            return response\n        except ClientError as e:\n            print(f\"Error generating presigned download URL: {e}\")\n            return None\n\n    def list_objects(self, prefix: str = \"\", delimiter: str = None):\n        try:\n            params = {\n                'Bucket': self.bucket_name,\n                'Prefix': prefix\n            }\n            if delimiter:\n                params['Delimiter'] = delimiter\n\n            response = self.s3_client.list_objects_v2(**params)\n\n            # Combine both regular contents and common prefixes (folders)\n            contents = response.get('Contents', [])\n\n            # If delimiter is used, add CommonPrefixes as separate objects with 'Prefix' field\n            if delimiter and 'CommonPrefixes' in response:\n                for common_prefix in response['CommonPrefixes']:\n                    # Keep the 'Prefix' field so routes/files.py can distinguish folders\n                    contents.append({\n                        'Prefix': common_prefix['Prefix']\n                    })\n\n            return contents\n        except ClientError as e:\n            print(f\"Error listing objects: {e}\")\n            return []\n\n    def delete_object(self, key: str):\n        try:\n            self.s3_client.delete_object(Bucket=self.bucket_name, Key=key)\n            return True\n        except ClientError as e:\n            print(f\"Error deleting object: {e}\")\n            return False\n\n    def copy_object(self, source_key: str, destination_key: str):\n        try:\n            copy_source = {'Bucket': self.bucket_name, 'Key': source_key}\n            self.s3_client.copy_object(\n                CopySource=copy_source,\n                Bucket=self.bucket_name,\n                Key=destination_key\n            )\n            return True\n        except ClientError as e:\n            print(f\"Error copying object: {e}\")\n            return False\n\n    def delete_multiple_objects(self, keys: list):\n        try:\n            objects = [{'Key': key} for key in keys]\n            response = self.s3_client.delete_objects(\n                Bucket=self.bucket_name,\n                Delete={'Objects': objects}\n            )\n            return response\n        except ClientError as e:\n            print(f\"Error deleting multiple objects: {e}\")\n            return None\n\n    def create_folder(self, folder_marker_key: str):\n        try:\n            # Create an empty .keep file to represent the folder\n            self.s3_client.put_object(\n                Bucket=self.bucket_name,\n                Key=folder_marker_key,\n                Body=b''\n            )\n            return True\n        except ClientError as e:\n            print(f\"Error creating folder: {e}\")\n            return False\n\ns3_service = S3Service()","size_bytes":4523},"start.sh":{"content":"#!/bin/bash\nset -e\n\n# Install npm dependencies if node_modules doesn't exist\nif [ ! -d \"node_modules\" ]; then\n  echo \"Installing npm dependencies...\"\n  npm install\nfi\n\n# Build the React frontend\necho \"Building frontend...\"\nnpx vite build\n\n# Start the Python backend\necho \"Starting Python backend...\"\nuv run uvicorn backend.main:app --host 0.0.0.0 --port 5000 --reload\n","size_bytes":368},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/components/FileCard.tsx":{"content":"import { MoreVertical, Download, Copy, Share2, Trash2 } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Tooltip, TooltipContent, TooltipTrigger } from '@/components/ui/tooltip';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { formatFileSize, formatDate, getFileTypeInfo } from '@/lib/fileUtils';\nimport type { S3File } from '@shared/schema';\nimport { cn } from '@/lib/utils';\n\ninterface FileCardProps {\n  file: S3File;\n  viewMode: 'grid' | 'list';\n  isSelected?: boolean;\n  onToggleSelect?: (fileId: string) => void;\n  onDownload?: (file: S3File) => void;\n  onCopy?: (file: S3File) => void;\n  onShare?: (file: S3File) => void;\n  onDelete?: (file: S3File) => void;\n}\n\nexport function FileCard({\n  file,\n  viewMode,\n  isSelected = false,\n  onToggleSelect,\n  onDownload,\n  onCopy,\n  onShare,\n  onDelete,\n}: FileCardProps) {\n  const fileTypeInfo = getFileTypeInfo(file.name, file.mimeType);\n  const Icon = fileTypeInfo.icon;\n\n  if (viewMode === 'list') {\n    return (\n      <div\n        className={cn(\n          'flex items-center gap-4 px-4 h-16 rounded-lg border border-transparent',\n          'hover-elevate transition-all',\n          isSelected && 'bg-primary/5 border-primary/20'\n        )}\n        data-testid={`file-item-${file.key}`}\n      >\n        {onToggleSelect && (\n          <Checkbox\n            checked={isSelected}\n            onCheckedChange={() => onToggleSelect(file.id || file.key)}\n            data-testid={`checkbox-${file.key}`}\n          />\n        )}\n        \n        <div className={cn('flex items-center justify-center w-10 h-10 rounded-lg', fileTypeInfo.bgColor)}>\n          <Icon className={cn('h-5 w-5', fileTypeInfo.color)} />\n        </div>\n        \n        <div className=\"flex-1 min-w-0\">\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <p className=\"text-sm font-medium truncate\" data-testid={`file-name-${file.key}`}>\n                {file.name}\n              </p>\n            </TooltipTrigger>\n            <TooltipContent>{file.name}</TooltipContent>\n          </Tooltip>\n        </div>\n        \n        <p className=\"text-xs text-muted-foreground w-20 text-right font-mono\" data-testid={`file-size-${file.key}`}>\n          {formatFileSize(file.size)}\n        </p>\n        \n        <p className=\"text-xs text-muted-foreground w-32 text-right\" data-testid={`file-date-${file.key}`}>\n          {formatDate(file.lastModified)}\n        </p>\n        \n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" data-testid={`actions-${file.key}`}>\n              <MoreVertical className=\"h-4 w-4\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\">\n            {onDownload && (\n              <DropdownMenuItem onClick={() => onDownload(file)} data-testid={`download-${file.key}`}>\n                <Download className=\"h-4 w-4 mr-2\" />\n                Download\n              </DropdownMenuItem>\n            )}\n            {onCopy && (\n              <DropdownMenuItem onClick={() => onCopy(file)} data-testid={`copy-${file.key}`}>\n                <Copy className=\"h-4 w-4 mr-2\" />\n                Make a copy\n              </DropdownMenuItem>\n            )}\n            {onShare && (\n              <DropdownMenuItem onClick={() => onShare(file)} data-testid={`share-${file.key}`}>\n                <Share2 className=\"h-4 w-4 mr-2\" />\n                Share link\n              </DropdownMenuItem>\n            )}\n            {onDelete && (\n              <>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem\n                  onClick={() => onDelete(file)}\n                  className=\"text-destructive focus:text-destructive\"\n                  data-testid={`delete-${file.key}`}\n                >\n                  <Trash2 className=\"h-4 w-4 mr-2\" />\n                  Delete\n                </DropdownMenuItem>\n              </>\n            )}\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className={cn(\n        'relative group rounded-lg border bg-card hover-elevate transition-all p-4',\n        'flex flex-col items-center gap-3',\n        isSelected && 'bg-primary/5 border-primary/20'\n      )}\n      data-testid={`file-card-${file.key}`}\n    >\n      {onToggleSelect && (\n        <div className=\"absolute top-2 left-2 z-10\">\n          <Checkbox\n            checked={isSelected}\n            onCheckedChange={() => onToggleSelect(file.id || file.key)}\n            data-testid={`checkbox-${file.key}`}\n          />\n        </div>\n      )}\n      \n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"absolute top-2 right-2 h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity\"\n            data-testid={`actions-${file.key}`}\n          >\n            <MoreVertical className=\"h-4 w-4\" />\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent align=\"end\">\n          {onDownload && (\n            <DropdownMenuItem onClick={() => onDownload(file)} data-testid={`download-${file.key}`}>\n              <Download className=\"h-4 w-4 mr-2\" />\n              Download\n            </DropdownMenuItem>\n          )}\n          {onCopy && (\n            <DropdownMenuItem onClick={() => onCopy(file)} data-testid={`copy-${file.key}`}>\n              <Copy className=\"h-4 w-4 mr-2\" />\n              Make a copy\n            </DropdownMenuItem>\n          )}\n          {onShare && (\n            <DropdownMenuItem onClick={() => onShare(file)} data-testid={`share-${file.key}`}>\n              <Share2 className=\"h-4 w-4 mr-2\" />\n              Share link\n            </DropdownMenuItem>\n          )}\n          {onDelete && (\n            <>\n              <DropdownMenuSeparator />\n              <DropdownMenuItem\n                onClick={() => onDelete && onDelete(file)}\n                className=\"text-destructive focus:text-destructive\"\n                data-testid={`delete-${file.key}`}\n              >\n                <Trash2 className=\"h-4 w-4 mr-2\" />\n                Delete\n              </DropdownMenuItem>\n            </>\n          )}\n        </DropdownMenuContent>\n      </DropdownMenu>\n      \n      <div className={cn('w-16 h-16 rounded-lg flex items-center justify-center', fileTypeInfo.bgColor)}>\n        <Icon className={cn('h-8 w-8', fileTypeInfo.color)} />\n      </div>\n      \n      <div className=\"w-full text-center space-y-1\">\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <p className=\"text-sm font-medium truncate px-2\" data-testid={`file-name-${file.key}`}>\n              {file.name}\n            </p>\n          </TooltipTrigger>\n          <TooltipContent>{file.name}</TooltipContent>\n        </Tooltip>\n        \n        <div className=\"flex items-center justify-center gap-2 text-xs text-muted-foreground\">\n          <span className=\"font-mono\" data-testid={`file-size-${file.key}`}>\n            {formatFileSize(file.size)}\n          </span>\n          <span></span>\n          <span data-testid={`file-date-${file.key}`}>{formatDate(file.lastModified)}</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":7412},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"backend/routes/__init__.py":{"content":"# Routes package\n","size_bytes":17},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"backend/routes/files.py":{"content":"from fastapi import APIRouter, Depends, HTTPException, status\nfrom sqlalchemy.orm import Session\nfrom pydantic import BaseModel\nfrom datetime import datetime, timedelta\nimport uuid\nfrom backend.database.db import get_db\nfrom backend.models.user import User\nfrom backend.models.file import File, ShareLink\nfrom backend.auth.security import get_current_user, check_permission\nfrom backend.services.s3_service import s3_service\n\nrouter = APIRouter(prefix=\"/api/files\", tags=[\"File Management\"])\n\nclass UploadRequest(BaseModel):\n    filename: str\n    content_type: str\n    folder_path: str = \"/\"\n\nclass FileResponse(BaseModel):\n    id: int\n    filename: str\n    s3_key: str\n    file_size: int | None\n    content_type: str | None\n    folder_path: str\n    uploaded_at: datetime\n    owner_username: str\n\nclass BulkDeleteRequest(BaseModel):\n    file_ids: list[int]\n\nclass CopyFileRequest(BaseModel):\n    destination_folder: str = \"/\"\n\nclass CreateFolderRequest(BaseModel):\n    folder_name: str\n    parent_folder: str = \"/\"\n\nclass ShareFileRequest(BaseModel):\n    expires_in_hours: int = 24\n\n@router.post(\"/upload-url\")\nasync def get_upload_url(\n    request: UploadRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"write\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to upload files\"\n        )\n    \n    # Generate S3 key without UUID prefix - use exact filename\n    folder_prefix = request.folder_path.strip('/')\n    s3_key = f\"{folder_prefix}/{request.filename}\" if folder_prefix else request.filename\n    \n    presigned_data = s3_service.generate_presigned_upload_url(\n        s3_key,\n        request.content_type\n    )\n    \n    if not presigned_data:\n        raise HTTPException(\n            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n            detail=\"Failed to generate upload URL\"\n        )\n    \n    new_file = File(\n        filename=request.filename,\n        s3_key=s3_key,\n        content_type=request.content_type,\n        folder_path=request.folder_path,\n        owner_id=current_user.id\n    )\n    \n    db.add(new_file)\n    db.commit()\n    db.refresh(new_file)\n    \n    return {\n        \"file_id\": new_file.id,\n        \"upload_url\": presigned_data['url'],\n        \"upload_fields\": presigned_data['fields'],\n        \"s3_key\": s3_key\n    }\n\n@router.post(\"/{file_id}/complete-upload\")\nasync def complete_upload(\n    file_id: int,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    file = db.query(File).filter(File.id == file_id).first()\n    if not file:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"File not found\"\n        )\n    \n    # Get file size from S3\n    s3_objects = s3_service.list_objects(prefix=file.s3_key)\n    for obj in s3_objects:\n        if obj.get('Key') == file.s3_key:\n            file.file_size = obj.get('Size')\n            break\n    \n    db.commit()\n    db.refresh(file)\n    \n    return {\"message\": \"Upload completed\", \"file_size\": file.file_size}\n\n@router.get(\"/folders\")\nasync def list_folders(\n    folder_path: str = \"/\",\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"read\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to view folders\"\n        )\n    \n    # Convert UI folder path to S3 prefix (root \"/\" becomes empty string \"\")\n    prefix = folder_path.strip('/') + '/' if folder_path.strip('/') else ''\n    s3_objects = s3_service.list_objects(prefix=prefix)\n    \n    folders = set()\n    \n    for obj in s3_objects:\n        s3_key = obj.get('Key', '')\n        relative_path = s3_key[len(prefix):] if prefix else s3_key\n        \n        # Check if this is a folder marker (ends with /)\n        if s3_key.endswith('/'):\n            folder_name = s3_key.rstrip('/').split('/')[-1] if s3_key.rstrip('/') else '/'\n            if folder_name and len(relative_path.rstrip('/').split('/')) == 1:\n                folders.add(folder_name)\n            continue\n        \n        # Extract folder names from file paths (first level only)\n        if '/' in relative_path:\n            folder_name = relative_path.split('/')[0]\n            if folder_name:\n                folders.add(folder_name)\n    \n    # Convert folder named \"/\" to \"slash\" for display\n    folder_list = []\n    for folder in sorted(folders):\n        display_name = \"[slash]\" if folder == \"/\" else folder\n        actual_path = f\"{folder_path.rstrip('/')}/{folder}\"\n        folder_list.append({\"name\": display_name, \"path\": actual_path})\n    \n    return folder_list\n\n@router.get(\"/\", include_in_schema=True)\n@router.get(\"\", include_in_schema=False)\nasync def list_files(\n    folder_path: str = \"/\",\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"read\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to view files\"\n        )\n    \n    # Get files from database for this folder\n    db_files = db.query(File).filter(File.folder_path == folder_path).all()\n    db_files_dict = {file.s3_key: file for file in db_files}\n    \n    # Convert UI folder path to S3 prefix\n    # Root \"/\" becomes empty string \"\"\n    # Other paths like \"/arshak\" become \"arshak/\"\n    if folder_path == \"/\":\n        prefix = \"\"\n    else:\n        prefix = folder_path.strip('/') + '/'\n    \n    # List S3 objects with delimiter to get folders\n    # Returns items from both 'Contents' and 'CommonPrefixes'\n    s3_objects = s3_service.list_objects(prefix=prefix, delimiter='/')\n    \n    files_result = []\n    folders_result = set()\n    seen_keys = set()\n    \n    # Process S3 objects\n    for obj in s3_objects:\n        # Check if this is a CommonPrefix (folder) - has 'Prefix' instead of 'Key'\n        if 'Prefix' in obj and 'Key' not in obj:\n            # This is a folder from CommonPrefixes\n            folder_prefix = obj['Prefix']\n            # Extract just the folder name (last part before the trailing /)\n            folder_name = folder_prefix.rstrip('/').split('/')[-1]\n            if folder_name:\n                folders_result.add(folder_name)\n            elif folder_prefix == '/':\n                # Special case: top-level \"/\" folder\n                folders_result.add('/')\n            continue\n        \n        s3_key = obj.get('Key', '')\n        \n        # Skip empty keys\n        if not s3_key:\n            continue\n        \n        # Skip .keep sentinel files\n        if s3_key.endswith('/.keep') or s3_key == '.keep':\n            continue\n        \n        # Get relative path within current folder\n        relative_path = s3_key[len(prefix):] if prefix else s3_key\n        \n        # If it's a folder marker object (ends with /), skip it\n        # (These are typically handled by CommonPrefixes)\n        if s3_key.endswith('/'):\n            continue\n        \n        # With delimiter, files in subfolders should not appear here\n        # But if they do, skip them (they belong in a subfolder)\n        if '/' in relative_path:\n            continue\n        \n        # This is a file in the current directory\n        seen_keys.add(s3_key)\n        \n        # Check if we have DB record for this file\n        if s3_key in db_files_dict:\n            db_file = db_files_dict[s3_key]\n            files_result.append({\n                \"id\": db_file.id,\n                \"filename\": db_file.filename,\n                \"s3_key\": s3_key,\n                \"file_size\": obj.get('Size', db_file.file_size),\n                \"content_type\": db_file.content_type,\n                \"folder_path\": folder_path,\n                \"uploaded_at\": db_file.uploaded_at.isoformat(),\n                \"owner_username\": db_file.owner.username if db_file.owner else \"Unknown\",\n                \"type\": \"file\"\n            })\n        else:\n            # File exists in S3 but not in DB - add it anyway\n            filename = relative_path\n            files_result.append({\n                \"id\": None,\n                \"filename\": filename,\n                \"s3_key\": s3_key,\n                \"file_size\": obj.get('Size'),\n                \"content_type\": None,\n                \"folder_path\": folder_path,\n                \"uploaded_at\": obj.get('LastModified').isoformat() if obj.get('LastModified') else None,\n                \"owner_username\": \"External\",\n                \"type\": \"file\"\n            })\n    \n    # Add DB files that might not be in S3 anymore (edge case)\n    for s3_key, db_file in db_files_dict.items():\n        if s3_key not in seen_keys:\n            files_result.append({\n                \"id\": db_file.id,\n                \"filename\": db_file.filename,\n                \"s3_key\": s3_key,\n                \"file_size\": db_file.file_size,\n                \"content_type\": db_file.content_type,\n                \"folder_path\": folder_path,\n                \"uploaded_at\": db_file.uploaded_at.isoformat(),\n                \"owner_username\": db_file.owner.username if db_file.owner else \"Unknown\",\n                \"type\": \"file\"\n            })\n    \n    # Add folders to the result\n    for folder_name in sorted(folders_result):\n        # Calculate the actual folder path for navigation\n        if folder_name == '/':\n            # Special handling for \"/\" folder at root\n            display_name = \"/\"\n            actual_folder_path = \"/\"\n        else:\n            display_name = folder_name\n            if folder_path == \"/\":\n                actual_folder_path = f\"/{folder_name}\"\n            else:\n                actual_folder_path = f\"{folder_path.rstrip('/')}/{folder_name}\"\n        \n        # Insert folders at the beginning\n        files_result.insert(0, {\n            \"id\": None,\n            \"filename\": display_name,\n            \"s3_key\": None,\n            \"file_size\": None,\n            \"content_type\": None,\n            \"folder_path\": actual_folder_path,\n            \"uploaded_at\": None,\n            \"owner_username\": None,\n            \"type\": \"folder\"\n        })\n    \n    return files_result\n\n@router.get(\"/{file_id}/download-url\")\nasync def get_download_url(\n    file_id: int,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"read\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to download files\"\n        )\n    \n    file = db.query(File).filter(File.id == file_id).first()\n    if not file:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"File not found\"\n        )\n    \n    download_url = s3_service.generate_presigned_download_url(file.s3_key)\n    \n    if not download_url:\n        raise HTTPException(\n            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n            detail=\"Failed to generate download URL\"\n        )\n    \n    return {\n        \"download_url\": download_url,\n        \"filename\": file.filename\n    }\n\n@router.get(\"/download-by-key/{s3_key:path}\")\nasync def get_download_url_by_key(\n    s3_key: str,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"read\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to download files\"\n        )\n    \n    download_url = s3_service.generate_presigned_download_url(s3_key)\n    \n    if not download_url:\n        raise HTTPException(\n            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n            detail=\"Failed to generate download URL\"\n        )\n    \n    # Extract filename from S3 key\n    filename = s3_key.split('/')[-1]\n    \n    return {\n        \"download_url\": download_url,\n        \"filename\": filename\n    }\n\n@router.post(\"/{file_id}/copy\")\nasync def copy_file(\n    file_id: int,\n    request: CopyFileRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"copy\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to copy files\"\n        )\n    \n    original_file = db.query(File).filter(File.id == file_id).first()\n    if not original_file:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"File not found\"\n        )\n    \n    new_s3_key = f\"{request.destination_folder.strip('/')}/{original_file.filename}\"\n    \n    success = s3_service.copy_object(original_file.s3_key, new_s3_key)\n    \n    if not success:\n        raise HTTPException(\n            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n            detail=\"Failed to copy file in S3\"\n        )\n    \n    new_file = File(\n        filename=original_file.filename,\n        s3_key=new_s3_key,\n        file_size=original_file.file_size,\n        content_type=original_file.content_type,\n        folder_path=request.destination_folder,\n        owner_id=current_user.id\n    )\n    \n    db.add(new_file)\n    db.commit()\n    db.refresh(new_file)\n    \n    return {\n        \"id\": new_file.id,\n        \"message\": \"File copied successfully\"\n    }\n\n@router.delete(\"/{file_id}\")\nasync def delete_file(\n    file_id: int,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"delete\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to delete files\"\n        )\n    \n    file = db.query(File).filter(File.id == file_id).first()\n    if not file:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"File not found\"\n        )\n    \n    s3_service.delete_object(file.s3_key)\n    \n    db.delete(file)\n    db.commit()\n    \n    return {\"message\": \"File deleted successfully\"}\n\n@router.delete(\"/by-key/{s3_key:path}\")\nasync def delete_file_by_key(\n    s3_key: str,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"delete\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to delete files\"\n        )\n    \n    # Delete from S3\n    success = s3_service.delete_object(s3_key)\n    \n    if not success:\n        raise HTTPException(\n            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n            detail=\"Failed to delete file from S3\"\n        )\n    \n    # Also delete from DB if it exists\n    file = db.query(File).filter(File.s3_key == s3_key).first()\n    if file:\n        db.delete(file)\n        db.commit()\n    \n    return {\"message\": \"File deleted successfully\"}\n\n@router.post(\"/bulk-delete\")\nasync def bulk_delete_files(\n    request: BulkDeleteRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"delete\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to delete files\"\n        )\n    \n    files = db.query(File).filter(File.id.in_(request.file_ids)).all()\n    \n    if not files:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"No files found\"\n        )\n    \n    s3_keys = [file.s3_key for file in files]\n    s3_service.delete_multiple_objects(s3_keys)\n    \n    for file in files:\n        db.delete(file)\n    \n    db.commit()\n    \n    return {\"message\": f\"Deleted {len(files)} files successfully\"}\n\n@router.post(\"/create-folder\")\nasync def create_folder(\n    request: CreateFolderRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"write\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to create folders\"\n        )\n    \n    # Create folder marker in S3 (folder + .keep file)\n    parent_prefix = request.parent_folder.strip('/')\n    folder_path = f\"{parent_prefix}/{request.folder_name}\" if parent_prefix else request.folder_name\n    folder_marker_key = f\"{folder_path}/.keep\"\n    \n    # Upload empty .keep file to create the folder\n    success = s3_service.create_folder(folder_marker_key)\n    \n    if not success:\n        raise HTTPException(\n            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n            detail=\"Failed to create folder in S3\"\n        )\n    \n    return {\n        \"message\": \"Folder created successfully\",\n        \"folder_path\": f\"/{folder_path}\"\n    }\n\n@router.post(\"/{file_id}/share\")\nasync def create_share_link(\n    file_id: int,\n    request: ShareFileRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    if not check_permission(current_user, \"share\"):\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"You don't have permission to share files\"\n        )\n    \n    # Enforce maximum expiry of 12 hours\n    expires_in_hours = min(request.expires_in_hours, 12)\n    \n    file = db.query(File).filter(File.id == file_id).first()\n    if not file:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"File not found\"\n        )\n    \n    # Generate S3 presigned URL directly\n    expiration_seconds = expires_in_hours * 3600\n    presigned_url = s3_service.generate_presigned_download_url(file.s3_key, expiration=expiration_seconds)\n    \n    if not presigned_url:\n        raise HTTPException(\n            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,\n            detail=\"Failed to generate share link\"\n        )\n    \n    expires_at = datetime.utcnow() + timedelta(hours=expires_in_hours)\n    \n    return {\n        \"share_url\": presigned_url,\n        \"expires_at\": expires_at.isoformat(),\n        \"expires_in_hours\": expires_in_hours\n    }\n\n@router.get(\"/share/{share_token}\")\nasync def get_shared_file(\n    share_token: str,\n    db: Session = Depends(get_db)\n):\n    share_link = db.query(ShareLink).filter(ShareLink.share_token == share_token).first()\n    \n    if not share_link:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"Share link not found\"\n        )\n    \n    if share_link.expires_at < datetime.utcnow():\n        raise HTTPException(\n            status_code=status.HTTP_410_GONE,\n            detail=\"Share link has expired\"\n        )\n    \n    file = share_link.file\n    download_url = s3_service.generate_presigned_download_url(file.s3_key, expiration=3600)\n    \n    return {\n        \"filename\": file.filename,\n        \"file_size\": file.file_size,\n        \"content_type\": file.content_type,\n        \"download_url\": download_url\n    }\n","size_bytes":19085},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"backend/routes/auth.py":{"content":"from fastapi import APIRouter, Depends, HTTPException, status\nfrom sqlalchemy.orm import Session\nfrom pydantic import BaseModel\nfrom backend.database.db import get_db\nfrom backend.models.user import User\nfrom backend.auth.security import (\n    verify_password,\n    get_password_hash,\n    create_access_token,\n    get_current_user\n)\n\nrouter = APIRouter(prefix=\"/api/auth\", tags=[\"Authentication\"])\n\nclass LoginRequest(BaseModel):\n    username: str\n    password: str\n\nclass UserResponse(BaseModel):\n    id: int\n    username: str\n    email: str | None\n    is_admin: bool\n    is_active: bool\n    roles: list[dict]\n\n    class Config:\n        from_attributes = True\n\n@router.post(\"/login\")\nasync def login(request: LoginRequest, db: Session = Depends(get_db)):\n    user = db.query(User).filter(User.username == request.username).first()\n    \n    if not user or not verify_password(request.password, user.hashed_password):\n        raise HTTPException(\n            status_code=status.HTTP_401_UNAUTHORIZED,\n            detail=\"Incorrect username or password\"\n        )\n    \n    if not user.is_active:\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"User account is inactive\"\n        )\n    \n    access_token = create_access_token(data={\"sub\": user.username})\n    \n    roles = [\n        {\n            \"id\": role.id,\n            \"name\": role.name,\n            \"can_read\": role.can_read,\n            \"can_write\": role.can_write,\n            \"can_copy\": role.can_copy,\n            \"can_delete\": role.can_delete,\n            \"can_share\": role.can_share\n        }\n        for role in user.roles\n    ]\n    \n    return {\n        \"access_token\": access_token,\n        \"token_type\": \"bearer\",\n        \"user\": {\n            \"id\": user.id,\n            \"username\": user.username,\n            \"email\": user.email,\n            \"is_admin\": user.is_admin,\n            \"roles\": roles\n        }\n    }\n\n@router.get(\"/me\")\nasync def get_current_user_info(current_user: User = Depends(get_current_user)):\n    roles = [\n        {\n            \"id\": role.id,\n            \"name\": role.name,\n            \"can_read\": role.can_read,\n            \"can_write\": role.can_write,\n            \"can_copy\": role.can_copy,\n            \"can_delete\": role.can_delete,\n            \"can_share\": role.can_share\n        }\n        for role in current_user.roles\n    ]\n    \n    return {\n        \"id\": current_user.id,\n        \"username\": current_user.username,\n        \"email\": current_user.email,\n        \"is_admin\": current_user.is_admin,\n        \"is_active\": current_user.is_active,\n        \"roles\": roles\n    }\n","size_bytes":2611},"backend/routes/users.py":{"content":"from fastapi import APIRouter, Depends, HTTPException, status\nfrom sqlalchemy.orm import Session\nfrom pydantic import BaseModel\nfrom backend.database.db import get_db\nfrom backend.models.user import User, Role\nfrom backend.auth.security import (\n    get_password_hash,\n    get_current_admin_user\n)\n\nrouter = APIRouter(prefix=\"/api/users\", tags=[\"User Management\"])\n\nclass CreateUserRequest(BaseModel):\n    username: str\n    password: str\n    email: str | None = None\n    is_admin: bool = False\n    role_ids: list[int] = []\n\nclass UpdateUserRequest(BaseModel):\n    email: str | None = None\n    is_active: bool | None = None\n    is_admin: bool | None = None\n    role_ids: list[int] | None = None\n\n@router.post(\"/\")\nasync def create_user(\n    request: CreateUserRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_admin_user)\n):\n    existing_user = db.query(User).filter(User.username == request.username).first()\n    if existing_user:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=\"Username already exists\"\n        )\n    \n    new_user = User(\n        username=request.username,\n        email=request.email,\n        hashed_password=get_password_hash(request.password),\n        is_admin=request.is_admin,\n        created_by=current_user.id\n    )\n    \n    if request.role_ids:\n        roles = db.query(Role).filter(Role.id.in_(request.role_ids)).all()\n        new_user.roles = roles\n    \n    db.add(new_user)\n    db.commit()\n    db.refresh(new_user)\n    \n    return {\n        \"id\": new_user.id,\n        \"username\": new_user.username,\n        \"email\": new_user.email,\n        \"is_admin\": new_user.is_admin,\n        \"is_active\": new_user.is_active\n    }\n\n@router.get(\"/\", include_in_schema=True)\n@router.get(\"\", include_in_schema=False)\nasync def list_users(\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_admin_user)\n):\n    users = db.query(User).all()\n    return [\n        {\n            \"id\": user.id,\n            \"username\": user.username,\n            \"email\": user.email,\n            \"is_admin\": user.is_admin,\n            \"is_active\": user.is_active,\n            \"roles\": [\n                {\n                    \"id\": role.id,\n                    \"name\": role.name,\n                    \"can_read\": role.can_read,\n                    \"can_write\": role.can_write,\n                    \"can_copy\": role.can_copy,\n                    \"can_delete\": role.can_delete,\n                    \"can_share\": role.can_share\n                }\n                for role in user.roles\n            ]\n        }\n        for user in users\n    ]\n\n@router.put(\"/{user_id}\")\nasync def update_user(\n    user_id: int,\n    request: UpdateUserRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_admin_user)\n):\n    user = db.query(User).filter(User.id == user_id).first()\n    if not user:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"User not found\"\n        )\n    \n    if request.email is not None:\n        user.email = request.email\n    if request.is_active is not None:\n        user.is_active = request.is_active\n    if request.is_admin is not None:\n        user.is_admin = request.is_admin\n    if request.role_ids is not None:\n        roles = db.query(Role).filter(Role.id.in_(request.role_ids)).all()\n        user.roles = roles\n    \n    db.commit()\n    db.refresh(user)\n    \n    return {\n        \"id\": user.id,\n        \"username\": user.username,\n        \"email\": user.email,\n        \"is_admin\": user.is_admin,\n        \"is_active\": user.is_active\n    }\n\n@router.delete(\"/{user_id}\")\nasync def delete_user(\n    user_id: int,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_admin_user)\n):\n    if user_id == current_user.id:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=\"Cannot delete yourself\"\n        )\n    \n    user = db.query(User).filter(User.id == user_id).first()\n    if not user:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"User not found\"\n        )\n    \n    db.delete(user)\n    db.commit()\n    \n    return {\"message\": \"User deleted successfully\"}\n","size_bytes":4283},"client/src/components/UploadProgress.tsx":{"content":"import { X, CheckCircle2, AlertCircle, Loader2 } from 'lucide-react';\nimport { Progress } from '@/components/ui/progress';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\n\nexport interface UploadItem {\n  id: string;\n  name: string;\n  progress: number;\n  status: 'uploading' | 'success' | 'error';\n  error?: string;\n}\n\ninterface UploadProgressProps {\n  uploads: UploadItem[];\n  onDismiss?: (id: string) => void;\n}\n\nexport function UploadProgress({ uploads, onDismiss }: UploadProgressProps) {\n  if (uploads.length === 0) return null;\n\n  return (\n    <div className=\"fixed bottom-4 right-4 z-50 w-full max-w-sm space-y-2\" data-testid=\"upload-progress\">\n      {uploads.map((upload) => (\n        <div\n          key={upload.id}\n          className=\"bg-card border border-card-border rounded-lg shadow-lg p-4 space-y-3\"\n          data-testid={`upload-item-${upload.id}`}\n        >\n          <div className=\"flex items-start gap-3\">\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center gap-2 mb-1\">\n                {upload.status === 'uploading' && (\n                  <Loader2 className=\"h-4 w-4 text-primary animate-spin flex-shrink-0\" />\n                )}\n                {upload.status === 'success' && (\n                  <CheckCircle2 className=\"h-4 w-4 text-green-600 flex-shrink-0\" />\n                )}\n                {upload.status === 'error' && (\n                  <AlertCircle className=\"h-4 w-4 text-destructive flex-shrink-0\" />\n                )}\n                <p className=\"text-sm font-medium truncate\" title={upload.name}>\n                  {upload.name}\n                </p>\n              </div>\n              \n              {upload.status === 'uploading' && (\n                <div className=\"space-y-1\">\n                  <Progress value={upload.progress} className=\"h-1.5\" />\n                  <p className=\"text-xs text-muted-foreground\">{upload.progress}%</p>\n                </div>\n              )}\n              \n              {upload.status === 'success' && (\n                <p className=\"text-xs text-green-600\">Upload complete</p>\n              )}\n              \n              {upload.status === 'error' && (\n                <p className=\"text-xs text-destructive\">{upload.error || 'Upload failed'}</p>\n              )}\n            </div>\n            \n            {onDismiss && upload.status !== 'uploading' && (\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-6 w-6 flex-shrink-0\"\n                onClick={() => onDismiss(upload.id)}\n                data-testid={`dismiss-upload-${upload.id}`}\n              >\n                <X className=\"h-3 w-3\" />\n              </Button>\n            )}\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n","size_bytes":2817},"backend/routes/roles.py":{"content":"from fastapi import APIRouter, Depends, HTTPException, status\nfrom sqlalchemy.orm import Session\nfrom pydantic import BaseModel\nfrom backend.database.db import get_db\nfrom backend.models.user import User, Role\nfrom backend.auth.security import get_current_admin_user\n\nrouter = APIRouter(prefix=\"/api/roles\", tags=[\"Role Management\"])\n\nclass CreateRoleRequest(BaseModel):\n    name: str\n    description: str | None = None\n    can_read: bool = True\n    can_write: bool = False\n    can_copy: bool = False\n    can_delete: bool = False\n    can_share: bool = False\n\nclass UpdateRoleRequest(BaseModel):\n    description: str | None = None\n    can_read: bool | None = None\n    can_write: bool | None = None\n    can_copy: bool | None = None\n    can_delete: bool | None = None\n    can_share: bool | None = None\n\n@router.post(\"/\")\nasync def create_role(\n    request: CreateRoleRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_admin_user)\n):\n    existing_role = db.query(Role).filter(Role.name == request.name).first()\n    if existing_role:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=\"Role name already exists\"\n        )\n    \n    new_role = Role(\n        name=request.name,\n        description=request.description,\n        can_read=request.can_read,\n        can_write=request.can_write,\n        can_copy=request.can_copy,\n        can_delete=request.can_delete,\n        can_share=request.can_share\n    )\n    \n    db.add(new_role)\n    db.commit()\n    db.refresh(new_role)\n    \n    return {\n        \"id\": new_role.id,\n        \"name\": new_role.name,\n        \"description\": new_role.description,\n        \"can_read\": new_role.can_read,\n        \"can_write\": new_role.can_write,\n        \"can_copy\": new_role.can_copy,\n        \"can_delete\": new_role.can_delete,\n        \"can_share\": new_role.can_share\n    }\n\n@router.get(\"/\", include_in_schema=True)\n@router.get(\"\", include_in_schema=False)\nasync def list_roles(db: Session = Depends(get_db)):\n    roles = db.query(Role).all()\n    return [\n        {\n            \"id\": role.id,\n            \"name\": role.name,\n            \"description\": role.description,\n            \"can_read\": role.can_read,\n            \"can_write\": role.can_write,\n            \"can_copy\": role.can_copy,\n            \"can_delete\": role.can_delete,\n            \"can_share\": role.can_share\n        }\n        for role in roles\n    ]\n\n@router.put(\"/{role_id}\")\nasync def update_role(\n    role_id: int,\n    request: UpdateRoleRequest,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_admin_user)\n):\n    role = db.query(Role).filter(Role.id == role_id).first()\n    if not role:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"Role not found\"\n        )\n    \n    if request.description is not None:\n        role.description = request.description\n    if request.can_read is not None:\n        role.can_read = request.can_read\n    if request.can_write is not None:\n        role.can_write = request.can_write\n    if request.can_copy is not None:\n        role.can_copy = request.can_copy\n    if request.can_delete is not None:\n        role.can_delete = request.can_delete\n    if request.can_share is not None:\n        role.can_share = request.can_share\n    \n    db.commit()\n    db.refresh(role)\n    \n    return {\n        \"id\": role.id,\n        \"name\": role.name,\n        \"description\": role.description,\n        \"can_read\": role.can_read,\n        \"can_write\": role.can_write,\n        \"can_copy\": role.can_copy,\n        \"can_delete\": role.can_delete,\n        \"can_share\": role.can_share\n    }\n\n@router.delete(\"/{role_id}\")\nasync def delete_role(\n    role_id: int,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_admin_user)\n):\n    role = db.query(Role).filter(Role.id == role_id).first()\n    if not role:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND,\n            detail=\"Role not found\"\n        )\n    \n    db.delete(role)\n    db.commit()\n    \n    return {\"message\": \"Role deleted successfully\"}\n","size_bytes":4122}},"version":2}